<!DOCTYPE html>
<!-- saved from url=(0101)http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html -->
<html lang="zh-cn"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script async="" src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/analytics.js.下载"></script>

<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园</title>
<link type="text/css" rel="stylesheet" href="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/blog-common.css">
<link id="MainCss" type="text/css" rel="stylesheet" href="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/bundle-LessIsMoreRight.css">
<link type="text/css" rel="stylesheet" href="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/88841.css">
<link id="mobile-style" media="only screen and (max-width: 768px)" type="text/css" rel="stylesheet" href="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/bundle-LessIsMoreRight-mobile.css">
<link title="RSS" type="application/rss+xml" rel="alternate" href="http://www.cnblogs.com/OceanEyes/rss">
<link title="RSD" type="application/rsd+xml" rel="EditURI" href="http://www.cnblogs.com/OceanEyes/rsd.xml">
<link type="application/wlwmanifest+xml" rel="wlwmanifest" href="http://www.cnblogs.com/OceanEyes/wlwmanifest.xml">
<script src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/jquery.js.下载" type="text/javascript"></script>  
<script type="text/javascript">var currentBlogApp = 'OceanEyes', cb_enable_mathjax=false;var isLogined=false;</script>
<script src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/blog-common.js.下载" type="text/javascript"></script>
</head>
<body><link href="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/jiathis_share.css" rel="stylesheet" type="text/css"><div class="jiathis_style" style="height: auto; position: fixed; z-index: 100000000; top: 150px; right: 0px; overflow: hidden; width: 26px;"><table cellpadding="0" cellspacing="0"><tbody style="background:transparent"><tr><td style="background:transparent"><img src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/r.gif" style="cursor:pointer;" onmouseover="$CKE.over()" onclick="$CKE.center(this)"></td><td><div><div class="jiadiv_01"><div style="width:100%;background:#F2F2F2;border-bottom:1px solid #E5E5E5;line-height:200%;padding-left:5px;font-size:12px"><table width="100%"><tbody><tr class="jt_sharetitle"><td align="left" style="text-align:left;line-height:25px;font-size:14px;font-weight:bold;color:#000000;">分享到...</td><td align="right" style="text-align:right;"><img src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/img_exit.gif" border="0" style="opacity:0.5;filter:alpha(opacity=50);margin:0 10px;cursor:pointer;" onclick="$CKE.shareClose();"></td></tr></tbody></table></div><div class="jiadiv_02" style="width:100%;" id="jiathis_sers"><a href="javascript:;" onclick="jiathis_sendto(&#39;weixin&#39;);return false;" class="jiatitle"><span class="jtico jtico_weixin">微信</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;tsina&#39;);return false;" class="jiatitle"><span class="jtico jtico_tsina">微博</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;copy&#39;);return false;" class="jiatitle"><span class="jtico jtico_copy">复制网址</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;email&#39;);return false;" class="jiatitle"><span class="jtico jtico_email">邮件</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;cqq&#39;);return false;" class="jiatitle"><span class="jtico jtico_cqq">QQ好友</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;qzone&#39;);return false;" class="jiatitle"><span class="jtico jtico_qzone">QQ空间</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;renren&#39;);return false;" class="jiatitle"><span class="jtico jtico_renren">人人网</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;kaixin001&#39;);return false;" class="jiatitle"><span class="jtico jtico_kaixin001">开心网</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;evernote&#39;);return false;" class="jiatitle"><span class="jtico jtico_evernote">印象笔记</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;linkedin&#39;);return false;" class="jiatitle"><span class="jtico jtico_linkedin">领英</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;feixin&#39;);return false;" class="jiatitle"><span class="jtico jtico_feixin">飞信</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;douban&#39;);return false;" class="jiatitle"><span class="jtico jtico_douban">豆瓣</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;twitter&#39;);return false;" class="jiatitle"><span class="jtico jtico_twitter">Twitter</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;fb&#39;);return false;" class="jiatitle"><span class="jtico jtico_fb">Facebook</span></a><a href="javascript:;" onclick="jiathis_sendto(&#39;ishare&#39;);return false;" class="jiatitle"><span class="jtico jtico_ishare">一键分享</span></a><a href="javascript:;" onclick="$CKE.center(this);return false;" class="jiatitle"><span class="jtico jtico_jiathis">查看更多(96)</span></a><div style="clear:both"></div></div><div class="ckepopBottom" style="width:100%;"><div style="float:left;font-size:10px"><a href="http://www.jiathis.com/help/html/what-is-jiathis" class="link_01" style="color:#333333;display:none;" target="_blank">这是什么工具?</a></div><div style="float:right;font-size:11px;margin:0 5px 0 0;"><img src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/img_012.gif" align="absmiddle" border="0"><a href="http://www.jiathis.com/index2" style="color:#333333;padding:0 3px;" class="link_01" target="_blank">JiaThis</a></div><div style="clear:both"></div></div></div></div></td></tr></tbody></table></div><iframe frameborder="0" style="position: absolute; display: none;" src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/saved_resource.html"></iframe><div class="jiathis_style" style="height: auto; position: absolute; z-index: 100000000; display: none; top: 50%; left: 50%; overflow: auto;"><div style="border:10px solid #7F7F7F; width:300px;"><div class="jiadiv_01" style="width:300px;"><div style="background:#F2F2F2;line-height:100%;height:30px;overflow:hidden;width:300px;"><table width="100%" style="margin:5px 0 0 0;"><tbody><tr class="jt_sharetitle" style="line-height:20px!important;"><td align="left" style="text-align:left;font-size:12px;">分享到各大网站</td><td align="right"><img src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/img_exit.gif" border="0" style="margin:0 4px;cursor:pointer;" onclick="$CKE.centerClose();"></td></tr></tbody></table></div><div class="searchTxtCont"><div style="background:url(http://v2.jiathis.com/code/images/img_so.gif) no-repeat center;height:30px; width:281px"><form onsubmit="return false;"><input class="searchTxt" name="" type="text" onclick="this.value=&#39;&#39;;this.style.color=&#39;#000&#39;;" value="输入网站名或拼音缩写" onkeyup="$CKE.choose(this);"></form></div></div><div id="jiathis_sharelist" class="jiadiv_02" style="width:300px;height:300px;overflow-y:auto;"><a href="javascript:;" onclick="jiathis_sendto(&#39;weixin&#39;);return false;" class="jiatitle"><span class="jtico jtico_weixin">微信</span><input type="hidden" value="weixin,微信,wx"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;tsina&#39;);return false;" class="jiatitle"><span class="jtico jtico_tsina">微博</span><input type="hidden" value="tsina,微博,xlwb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;cqq&#39;);return false;" class="jiatitle"><span class="jtico jtico_cqq">QQ好友</span><input type="hidden" value="cqq,QQ好友,cqq"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;qzone&#39;);return false;" class="jiatitle"><span class="jtico jtico_qzone">QQ空间</span><input type="hidden" value="qzone,QQ空间,qqkj"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;copy&#39;);return false;" class="jiatitle"><span class="jtico jtico_copy">复制网址</span><input type="hidden" value="copy,复制网址,fzwz"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;fav&#39;);return false;" class="jiatitle"><span class="jtico jtico_fav">收藏夹</span><input type="hidden" value="fav,收藏夹,scj"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;print&#39;);return false;" class="jiatitle"><span class="jtico jtico_print">打印</span><input type="hidden" value="print,打印,dy"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;email&#39;);return false;" class="jiatitle"><span class="jtico jtico_email">邮件</span><input type="hidden" value="email,邮件,yj"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;renren&#39;);return false;" class="jiatitle"><span class="jtico jtico_renren">人人网</span><input type="hidden" value="renren,人人网,rrw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;kaixin001&#39;);return false;" class="jiatitle"><span class="jtico jtico_kaixin001">开心网</span><input type="hidden" value="kaixin001,开心网,kxw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;evernote&#39;);return false;" class="jiatitle"><span class="jtico jtico_evernote">印象笔记</span><input type="hidden" value="evernote,印象笔记,evernote"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;linkedin&#39;);return false;" class="jiatitle"><span class="jtico jtico_linkedin">领英</span><input type="hidden" value="linkedin,领英,linkedin"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;feixin&#39;);return false;" class="jiatitle"><span class="jtico jtico_feixin">飞信</span><input type="hidden" value="feixin,飞信,fx"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;douban&#39;);return false;" class="jiatitle"><span class="jtico jtico_douban">豆瓣</span><input type="hidden" value="douban,豆瓣,db"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;twitter&#39;);return false;" class="jiatitle"><span class="jtico jtico_twitter">Twitter</span><input type="hidden" value="twitter,Twitter,twitter"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;fb&#39;);return false;" class="jiatitle"><span class="jtico jtico_fb">Facebook</span><input type="hidden" value="fb,Facebook,facebook"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;ishare&#39;);return false;" class="jiatitle"><span class="jtico jtico_ishare">一键分享</span><input type="hidden" value="ishare,一键分享,yjfx"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;ujian&#39;);return false;" class="jiatitle"><span class="jtico jtico_ujian">猜你喜欢</span><input type="hidden" value="ujian,猜你喜欢,cnxh"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;yixin&#39;);return false;" class="jiatitle"><span class="jtico jtico_yixin">易信</span><input type="hidden" value="yixin,易信,yx"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;huaban&#39;);return false;" class="jiatitle"><span class="jtico jtico_huaban">花瓣网</span><input type="hidden" value="huaban,花瓣网,hbw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;tqq&#39;);return false;" class="jiatitle"><span class="jtico jtico_tqq">腾讯微博</span><input type="hidden" value="tqq,腾讯微博,txwb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;googleplus&#39;);return false;" class="jiatitle"><span class="jtico jtico_googleplus">Google+</span><input type="hidden" value="googleplus,Google+,googlej"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;alibaba&#39;);return false;" class="jiatitle"><span class="jtico jtico_alibaba">阿里巴巴</span><input type="hidden" value="alibaba,阿里巴巴,albb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;xiaoyou&#39;);return false;" class="jiatitle"><span class="jtico jtico_xiaoyou">朋友网</span><input type="hidden" value="xiaoyou,朋友网,pyw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;sdonote&#39;);return false;" class="jiatitle"><span class="jtico jtico_sdonote">麦库记事</span><input type="hidden" value="sdonote,麦库记事,mkjs"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;baidu&#39;);return false;" class="jiatitle"><span class="jtico jtico_baidu">百度搜藏</span><input type="hidden" value="baidu,百度搜藏,bdsc"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;gmail&#39;);return false;" class="jiatitle"><span class="jtico jtico_gmail">Gmail邮箱</span><input type="hidden" value="gmail,Gmail邮箱,gmailyx"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;ydnote&#39;);return false;" class="jiatitle"><span class="jtico jtico_ydnote">有道云笔记</span><input type="hidden" value="ydnote,有道云笔记,ydybj"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;tianya&#39;);return false;" class="jiatitle"><span class="jtico jtico_tianya">天涯社区</span><input type="hidden" value="tianya,天涯社区,tysq"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;tieba&#39;);return false;" class="jiatitle"><span class="jtico jtico_tieba">百度贴吧</span><input type="hidden" value="tieba,百度贴吧,bdtb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;qingbiji&#39;);return false;" class="jiatitle"><span class="jtico jtico_qingbiji">轻笔记</span><input type="hidden" value="qingbiji,轻笔记,qbj"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;tifeng&#39;);return false;" class="jiatitle"><span class="jtico jtico_tifeng">凤凰微博</span><input type="hidden" value="tifeng,凤凰微博,fhwb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;fanfou&#39;);return false;" class="jiatitle"><span class="jtico jtico_fanfou">饭否</span><input type="hidden" value="fanfou,饭否,ff"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;mingdao&#39;);return false;" class="jiatitle"><span class="jtico jtico_mingdao">明道</span><input type="hidden" value="mingdao,明道,md"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;douban9dian&#39;);return false;" class="jiatitle"><span class="jtico jtico_douban9dian">豆瓣9点</span><input type="hidden" value="douban9dian,豆瓣9点,db9d"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;google&#39;);return false;" class="jiatitle"><span class="jtico jtico_google">谷歌</span><input type="hidden" value="google,谷歌,gg"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;buzz&#39;);return false;" class="jiatitle"><span class="jtico jtico_buzz">谷歌Buzz</span><input type="hidden" value="buzz,谷歌Buzz,ggbuzz"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;youdao&#39;);return false;" class="jiatitle"><span class="jtico jtico_youdao">有道书签</span><input type="hidden" value="youdao,有道书签,ydsq"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;qq&#39;);return false;" class="jiatitle"><span class="jtico jtico_qq">QQ书签</span><input type="hidden" value="qq,QQ书签,qqsq"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;msn&#39;);return false;" class="jiatitle"><span class="jtico jtico_msn">MSN</span><input type="hidden" value="msn,MSN,msn"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;pinterest&#39;);return false;" class="jiatitle"><span class="jtico jtico_pinterest">Pinterest</span><input type="hidden" value="pinterest,Pinterest,pinterest"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;duitang&#39;);return false;" class="jiatitle"><span class="jtico jtico_duitang">堆糖</span><input type="hidden" value="duitang,堆糖,dt"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;tyaolan&#39;);return false;" class="jiatitle"><span class="jtico jtico_tyaolan">摇篮微博</span><input type="hidden" value="tyaolan,摇篮微博,ylwb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;hi&#39;);return false;" class="jiatitle"><span class="jtico jtico_hi">百度空间</span><input type="hidden" value="hi,百度空间,bdkj"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;hotmail&#39;);return false;" class="jiatitle"><span class="jtico jtico_hotmail">Hotmail邮箱</span><input type="hidden" value="hotmail,Hotmail邮箱,hotmailyx"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;xqw&#39;);return false;" class="jiatitle"><span class="jtico jtico_xqw">雪球</span><input type="hidden" value="xqw,雪球,xqw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;hexun&#39;);return false;" class="jiatitle"><span class="jtico jtico_hexun">和讯</span><input type="hidden" value="hexun,和讯,hx"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;139mail&#39;);return false;" class="jiatitle"><span class="jtico jtico_139mail">139邮箱</span><input type="hidden" value="139mail,139邮箱,139yx"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;189mail&#39;);return false;" class="jiatitle"><span class="jtico jtico_189mail">189邮箱</span><input type="hidden" value="189mail,189邮箱,189yx"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;189cn&#39;);return false;" class="jiatitle"><span class="jtico jtico_189cn">翼友圈</span><input type="hidden" value="189cn,翼友圈,yyq"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;tpeople&#39;);return false;" class="jiatitle"><span class="jtico jtico_tpeople">人民微博</span><input type="hidden" value="tpeople,人民微博,rmwb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;txinhua&#39;);return false;" class="jiatitle"><span class="jtico jtico_txinhua">新华微博</span><input type="hidden" value="txinhua,新华微博,xhwb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;translate&#39;);return false;" class="jiatitle"><span class="jtico jtico_translate">谷歌翻译</span><input type="hidden" value="translate,谷歌翻译,ggfy"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;tuita&#39;);return false;" class="jiatitle"><span class="jtico jtico_tuita">推他</span><input type="hidden" value="tuita,推他,tt"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;mop&#39;);return false;" class="jiatitle"><span class="jtico jtico_mop">猫扑推客</span><input type="hidden" value="mop,猫扑推客,mptk"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;meilishuo&#39;);return false;" class="jiatitle"><span class="jtico jtico_meilishuo">美丽说</span><input type="hidden" value="meilishuo,美丽说,mls"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;mogujie&#39;);return false;" class="jiatitle"><span class="jtico jtico_mogujie">蘑菇街</span><input type="hidden" value="mogujie,蘑菇街,mgj"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;ganniu&#39;);return false;" class="jiatitle"><span class="jtico jtico_ganniu">赶牛网</span><input type="hidden" value="ganniu,赶牛网,gnw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;poco&#39;);return false;" class="jiatitle"><span class="jtico jtico_poco">Poco网</span><input type="hidden" value="poco,Poco网,pocow"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;leihou&#39;);return false;" class="jiatitle"><span class="jtico jtico_leihou">雷猴网</span><input type="hidden" value="leihou,雷猴网,lhw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;thexun&#39;);return false;" class="jiatitle"><span class="jtico jtico_thexun">和讯微博</span><input type="hidden" value="thexun,和讯微博,hxwb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;dream163&#39;);return false;" class="jiatitle"><span class="jtico jtico_dream163">游戏江湖</span><input type="hidden" value="dream163,游戏江湖,yxjh"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;jcrb&#39;);return false;" class="jiatitle"><span class="jtico jtico_jcrb">法律微博</span><input type="hidden" value="jcrb,法律微博,flwb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;tumblr&#39;);return false;" class="jiatitle"><span class="jtico jtico_tumblr">Tumblr</span><input type="hidden" value="tumblr,Tumblr,tumblr"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;reddit&#39;);return false;" class="jiatitle"><span class="jtico jtico_reddit">Reddit</span><input type="hidden" value="reddit,Reddit,reddit"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;instapaper&#39;);return false;" class="jiatitle"><span class="jtico jtico_instapaper">Instapaper</span><input type="hidden" value="instapaper,Instapaper,instapaper"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;pocket&#39;);return false;" class="jiatitle"><span class="jtico jtico_pocket">Pocket</span><input type="hidden" value="pocket,Pocket,pocket"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;caimi&#39;);return false;" class="jiatitle"><span class="jtico jtico_caimi">财迷</span><input type="hidden" value="caimi,财迷,cm"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;iwo&#39;);return false;" class="jiatitle"><span class="jtico jtico_iwo">WO+分享</span><input type="hidden" value="iwo,WO+分享,iwo"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;waakee&#39;);return false;" class="jiatitle"><span class="jtico jtico_waakee">挖客网</span><input type="hidden" value="waakee,挖客网,wkw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;cyzone&#39;);return false;" class="jiatitle"><span class="jtico jtico_cyzone">创业邦</span><input type="hidden" value="cyzone,创业邦,cyb"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;99earth&#39;);return false;" class="jiatitle"><span class="jtico jtico_99earth">救救地球</span><input type="hidden" value="99earth,救救地球,jjdq"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;chouti&#39;);return false;" class="jiatitle"><span class="jtico jtico_chouti">抽屉网</span><input type="hidden" value="chouti,抽屉网,ctw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;dig24&#39;);return false;" class="jiatitle"><span class="jtico jtico_dig24">递客网</span><input type="hidden" value="dig24,递客网,dkw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;yijee&#39;);return false;" class="jiatitle"><span class="jtico jtico_yijee">易集网</span><input type="hidden" value="yijee,易集网,yjw"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;pdfonline&#39;);return false;" class="jiatitle"><span class="jtico jtico_pdfonline">Pdf在线转换</span><input type="hidden" value="pdfonline,Pdf在线转换,pdfzxzh"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;printfriendly&#39;);return false;" class="jiatitle"><span class="jtico jtico_printfriendly">友好打印</span><input type="hidden" value="printfriendly,友好打印,yhdy"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;w3c&#39;);return false;" class="jiatitle"><span class="jtico jtico_w3c">W3c验证</span><input type="hidden" value="w3c,W3c验证,w3cyz"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;bitly&#39;);return false;" class="jiatitle"><span class="jtico jtico_bitly">Bit.ly</span><input type="hidden" value="bitly,Bit.ly,bitly"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;digg&#39;);return false;" class="jiatitle"><span class="jtico jtico_digg">Digg</span><input type="hidden" value="digg,Digg,digg"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;mailru&#39;);return false;" class="jiatitle"><span class="jtico jtico_mailru">Mail.ru</span><input type="hidden" value="mailru,Mail.ru,mail.ru"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;diigo&#39;);return false;" class="jiatitle"><span class="jtico jtico_diigo">Diigo</span><input type="hidden" value="diigo,Diigo,diigo"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;friendfeed&#39;);return false;" class="jiatitle"><span class="jtico jtico_friendfeed">FriendFeed</span><input type="hidden" value="friendfeed,FriendFeed,friendfeed"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;myspace&#39;);return false;" class="jiatitle"><span class="jtico jtico_myspace">Myspace</span><input type="hidden" value="myspace,Myspace,myspace"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;mixx&#39;);return false;" class="jiatitle"><span class="jtico jtico_mixx">Mixx</span><input type="hidden" value="mixx,Mixx,mixx"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;netlog&#39;);return false;" class="jiatitle"><span class="jtico jtico_netlog">NetLog</span><input type="hidden" value="netlog,NetLog,netlog"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;netvibes&#39;);return false;" class="jiatitle"><span class="jtico jtico_netvibes">Netvibes</span><input type="hidden" value="netvibes,Netvibes,netvibes"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;phonefavs&#39;);return false;" class="jiatitle"><span class="jtico jtico_phonefavs">Phonefavs</span><input type="hidden" value="phonefavs,Phonefavs,phonefavs"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;pingfm&#39;);return false;" class="jiatitle"><span class="jtico jtico_pingfm">Ping.fm</span><input type="hidden" value="pingfm,Ping.fm,ping.fm"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;plaxo&#39;);return false;" class="jiatitle"><span class="jtico jtico_plaxo">Plaxo</span><input type="hidden" value="plaxo,Plaxo,plaxo"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;delicious&#39;);return false;" class="jiatitle"><span class="jtico jtico_delicious">Delicious</span><input type="hidden" value="delicious,Delicious,delicious"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;wong&#39;);return false;" class="jiatitle"><span class="jtico jtico_wong">Mister Wong</span><input type="hidden" value="wong,Mister Wong,misterwong"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;stumbleupon&#39;);return false;" class="jiatitle"><span class="jtico jtico_stumbleupon">Stumbleupon</span><input type="hidden" value="stumbleupon,Stumbleupon,stumbleupon"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;plurk&#39;);return false;" class="jiatitle"><span class="jtico jtico_plurk">Plurk</span><input type="hidden" value="plurk,Plurk,plurk"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;funp&#39;);return false;" class="jiatitle"><span class="jtico jtico_funp">Funp</span><input type="hidden" value="funp,Funp,funp"></a><a href="javascript:;" onclick="jiathis_sendto(&#39;myshare&#39;);return false;" class="jiatitle"><span class="jtico jtico_myshare">Myshare</span><input type="hidden" value="myshare,Myshare,myshare"></a><div style="clear:both"></div></div><div class="centerBottom"><div style="float:left;font-size:10px;"><a href="http://www.jiathis.com/help/html/what-is-jiathis" class="link_01" style="color:#333333;display:none;" target="_blank">这是什么工具?</a></div><div style="float:right;font-size:11px;margin:0 10px 0 0;"><img src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/img_012.gif" align="absmiddle" border="none">&nbsp;<a href="http://www.jiathis.com/index2" style="color:#333333;" class="link_01" target="_blank">JiaThis</a></div><div style="clear:both"></div></div></div></div></div><iframe frameborder="0" src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/jiathis_utility.html" style="display: none;"></iframe>
<a name="top"></a>
<!--PageBeginHtml Block Begin-->
<a href="https://github.com/MEyes"><img style="position: absolute; top: 0; right: 0; border: 0;" src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"></a>
<!--PageBeginHtml Block End-->

<div id="home">
<div id="header">
	<div id="blogTitle">
		
<!--done-->
<div class="title"><a id="Header1_HeaderTitle" class="headermaintitle" href="http://www.cnblogs.com/OceanEyes/"><b style="color:#2B6695;margin-left:30px">大鹏一日同风起，扶摇直上九万里</b></a></div>
<div class="subtitle"><div style="float:left;margin-left:11px;">
<img src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/o_apple-touch-icon.png" height="89px">
</div></div>



		
	</div><!--end: blogTitle 博客的标题和副标题 -->
	<div id="navigator">
		
<ul id="navList">
<li id="nav_sitehome"><a id="blog_nav_sitehome" class="menu" href="http://www.cnblogs.com/">博客园</a></li>
<li id="nav_myhome"><a id="blog_nav_myhome" class="menu" href="http://www.cnblogs.com/OceanEyes/">首页</a></li>
<li id="nav_newpost"><a id="blog_nav_newpost" class="menu" rel="nofollow" href="https://i.cnblogs.com/EditPosts.aspx?opt=1">新随笔</a></li>
<li id="nav_contact"><a id="blog_nav_contact" class="menu" rel="nofollow" href="https://msg.cnblogs.com/send/%E6%9C%A8%E5%AE%9B%E5%9F%8E%E4%B8%BB">联系</a></li>
<li id="nav_rss"><a id="blog_nav_rss" class="menu" href="http://www.cnblogs.com/OceanEyes/rss">订阅</a>
<!--<a id="blog_nav_rss_image" class="aHeaderXML" href="http://www.cnblogs.com/OceanEyes/rss"><img src="//www.cnblogs.com/images/xml.gif" alt="订阅" /></a>--></li>
<li id="nav_admin"><a id="blog_nav_admin" class="menu" rel="nofollow" href="https://i.cnblogs.com/">管理</a></li>
</ul>

		<div class="blogStats">
			
			<div id="blog_stats">
<!--done-->
随笔-152&nbsp;
文章-0&nbsp;
评论-1321&nbsp;
</div>
			
		</div><!--end: blogStats -->
	</div><!--end: navigator 博客导航栏 -->
</div><!--end: header 头部 -->
<div id="main">
	<div id="mainContent">
	<div class="forFlow">
		
<div id="post_detail">
<!--done-->
<div id="topics">
	<div class="post">
		<h1 class="postTitle">
			<a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html">ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇</a>
		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body"><a name="_labelTop"></a><div id="navCategory"><p style="font-size:18px"><b>阅读目录</b></p><ul><li><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#_label0">探索身份验证与授权</a></li><li><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#_label1">使用ASP.NET Identity 身份验证</a></li><li><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#_label2">使用角色进行授权</a></li><li><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#_label3">初始化数据，Seeding 数据库</a></li><li><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#_label4">小结</a></li></ul></div><blockquote>
<p><span style="font-size: 15px;">在<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-get-started-with-identity.html">前一篇</a>文章中，我介绍了ASP.NET Identity 基本API的运用并创建了若干用户账号。那么在本篇文章中，我将继续ASP.NET Identity 之旅，向您展示如何运用ASP.NET Identity 进行身份验证（Authentication）以及联合ASP.NET MVC 基于角色的授权（Role-Based Authorization）。</span></p>
<p><span style="font-size: 15px;">本文的示例，你可以在此下载和预览：</span></p>
<p><span style="font-size: 15px;"><strong><a href="http://myusermanagement.azurewebsites.net/" target="_blank">点此进行预览</a></strong></span></p>
<p><span style="font-size: 15px;"><a href="https://github.com/MEyes/ASP.NET-Identity-User-Management" target="_blank"><strong>点此下载示例代码</strong></a></span></p>
</blockquote>
<div style="text-align: right"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#_labelTop">回到顶部</a><a name="_label0"></a></div><h3><span style="font-size: 15px;">探索身份验证与授权</span></h3>
<p><span style="font-size: 15px;">在这一小节中，我将阐述和证明ASP.NET 身份验证和授权的工作原理和运行机制，然后介绍怎样使用Katana Middleware 和 ASP.NET Identity 进行身份验证。</span></p>
<p><span style="font-size: 15px;"><strong>1. 理解ASP.NET 表单身份验证与授权机制 </strong></span></p>
<p><span style="font-size: 15px;">谈到身份验证，我们接触的最多的可能就是表单身份验证（Form-based Authentication）。为了更好的去理解ASP.NET 表单身份验证与授权机制，我搬出几年前的一张旧图，表示HttpApplication 19个事件，它们分别在HttpModule 中被注册，这又被称为ASP.NET 管道（Pipeline）事件。通俗的讲，当请求到达服务器时，ASP.NET 运行时会依次触发这些事件：</span></p>
<p><img src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/299214-20150906225710154-350197778.png" alt=""></p>
<p><span style="font-size: 15px;">身份验证故名思义，验证的是用户提供的凭据（Credentials）。一旦验证通过，将产生唯一的Cookie标识并输出到浏览器。来自浏览器的下一次请求将包含此Cookie，对于ASP.NET 应用程序，我们熟知的<strong>FormsAuthenticationModule</strong>会对HttpApplication 的管道（Pipeline）事件<strong>AuthenticateRequest</strong> 进行注册，当请求经过ASP.NET Pipeline时，由ASP.NET Runtime 触发它，在该事件中，它会验证并解析该Cookie为对应的用户对象，它是一个实现了 IPrincipal接口的对象。<strong>PostAuthenticateRequest</strong> 事件在<strong>AuthenticateRequest</strong> 事件之后触发，表示用户身份已经检查完成 ，检查后的用户可以通过<strong>HttpContext</strong>的<strong>User</strong>属性获取并且<strong>HttpContext.User.Identity.IsAuthenticated</strong>属性为True。</span></p>
<p><span style="font-size: 15px;">如果将身份验证看作是"开门"的话，主人邀请你进屋，但这并不意味着你可以进入到卧室或者书房，可能你的活动场所仅限书房——这就是授权。在<strong>PostAuthenticateRequest</strong>事件触发过后，会触发<strong>AuthorizeRequest</strong> 事件，它在<strong><a name="OLE_LINK1"></a>UrlAuthorizationModule</strong> 中被注册（题外插一句：UrlAuthorizationModule 以及上面提到的FormsAuthenticationModule你可以在IIS 级别的.config文件中找到，这也是ASP.NET 和 IIS紧耦合关系的体现）。在该事件中，请求的URL会依据web.config中的<a href="https://msdn.microsoft.com/en-us/library/8d82143t(v=vs.110).aspx">authorization</a>&nbsp;配置节点进行授权，如下所示授予Kim以及所有Role为Administrator的成员具有访问权限，并且拒绝John以及匿名用户访问。</span></p>
<ol>
<li>
<div style="background: #f4f4f4;"><span style="color: blue; font-size: 15px;">&lt;<span style="color: maroon;">authorization<span style="color: blue;">&gt;</span> </span></span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp; <span style="color: blue;">&lt;<span style="color: maroon;">allow</span> <span style="color: red;">users</span>="Kim"/&gt;</span> </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp; &nbsp;<span style="color: blue;">&lt;<span style="color: maroon;">allow</span> <span style="color: red;">roles</span>="Administrator"/&gt;</span> </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp; <span style="color: blue;">&lt;<span style="color: maroon;">deny</span> <span style="color: red;">users</span>="John"/&gt;</span> </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp; &nbsp;<span style="color: blue;">&lt;<span style="color: maroon;">deny</span> <span style="color: red;">users</span>="?"/&gt;</span> </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="color: blue; font-size: 15px;">&lt;/<span style="color: maroon;">authorization<span style="color: blue;">&gt;</span> </span></span></div>
</li>
</ol>
<p><span style="font-size: 15px;">通过身份验证和授权，我们可以对应用程序敏感的区域进行受限访问，这确保了数据的安全性。</span></p>
<p><span style="font-size: 15px;"><strong>2.使用Katana进行身份验证 </strong></span></p>
<p><span style="font-size: 15px;">到目前为止，你可能已经对OWIN、Katana 、 Middleware 有了基本的了解，如果不清楚的话，请移步到<a href="http://www.cnblogs.com/OceanEyes/category/696137.html">此</a>浏览。</span></p>
<p><span style="font-size: 15px;">使用Katana，你可以选择几种不同类型的身份验证方式，我们可以通过Nuget来安装如下类型的身份验证：</span></p>
<ul>
<li><span style="font-size: 15px;">表单身份验证</span></li>
<li><span style="font-size: 15px;">社交身份验证（Twitter、Facebook、Google、Microsoft Account…）</span></li>
<li><span style="font-size: 15px;">Windows Azure</span></li>
<li><span style="font-size: 15px;">Active Directory</span></li>
<li><span style="font-size: 15px;">OpenID</span></li>
</ul>
<p><span style="font-size: 15px;">其中又以表单身份验证用的最为广泛，正如上面提到的那样，传统ASP.NET MVC 、Web Form 的表单身份验证实际由<strong><a name="OLE_LINK5"></a>FormsAuthenticationModule </strong>处理，而Katana重写了表单身份验证，所以有必要比较一下传统ASP.NET MVC &amp; Web Form 下表单身份验证与OWIN下表单身份验证的区别：</span></p>
<div style="text-align: right;">
<table style="border-collapse: collapse; height: 426px; width: 918px;" border="0"><colgroup><col style="width: 192px;"><col style="width: 192px;"><col style="width: 192px;"></colgroup>
<tbody valign="top">
<tr style="height: 23px;">
<td style="padding-left: 7px; padding-right: 7px; border: solid 0.5pt;">
<p><span style="font-size: 15px;">Features</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: solid 0.5pt; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">ASP.NET MVC &amp; Web Form Form Authentication</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: solid 0.5pt; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">OWIN Form Authentication</span></p>
</td>
</tr>
<tr style="height: 34px;">
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid 0.5pt; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">Cookie Authentication</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">√</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">√</span></p>
</td>
</tr>
<tr>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid 0.5pt; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;"><a name="OLE_LINK3"></a>Cookieless Authentication</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">√</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="color: #535353; font-family: 微软雅黑; font-size: 15px; background-color: white;">×</span></p>
</td>
</tr>
<tr>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid 0.5pt; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">Expiration</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">√</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">√</span></p>
</td>
</tr>
<tr>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid 0.5pt; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">Sliding Expiration</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">√</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">√</span></p>
</td>
</tr>
<tr>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid 0.5pt; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">Token Protection</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">√</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">√</span></p>
</td>
</tr>
<tr>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid 0.5pt; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">Claims Support</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="color: #535353; font-family: 微软雅黑; font-size: 15px; background-color: white;">×</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">√</span></p>
</td>
</tr>
<tr>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid 0.5pt; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">Unauthorized Redirection</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">√</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">√</span></p>
</td>
</tr>
</tbody>
</table>
</div>
<p><span style="font-size: 15px;">&nbsp;</span></p>
<p><span style="font-size: 15px;">从上表对比可以看出，Katana几乎实现了传统表单身份验证所有的功能，那我们怎么去使用它呢？还是像传统那样在web.config中指定吗？</span></p>
<p><span style="font-size: 15px;">非也非也，Katana 完全抛弃了FormsAuthenticationModule，实际上是通过Middleware来实现身份验证。默认情况下，Middleware在HttpApplication的PreRequestHandlerExecute 事件触发时链式执行，当然我们也可以将它指定在特定的阶段执行，通过使用<span style="color: red;"><strong>UseStageMarker</strong></span>方法，我们可以在AuthenticateRequest 阶段执行Middleware 进行身份验证。</span></p>
<p><span style="font-size: 15px;">那我们要怎样去实现呢？幸运的是，Katana已经帮助我们封装好了一个扩展方法，如下所示，</span></p>
<ol>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">app.UseCookieAuthentication(<span style="color: blue;">new</span> CookieAuthenticationOptions </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AuthenticationType = DefaultAuthenticationTypes.ApplicationCookie, </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoginPath = <span style="color: blue;">new</span> PathString("<span style="color: darkred;">/Account/Login</span>") </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;}); </span></div>
</li>
</ol>
<p><span style="font-size: 15px;">app.UseCookieAuthentication 是一个扩展方法，它的内部帮我们做了如下几件事：</span></p>
<ul>
<li><span style="font-size: 15px;">使用app.Use(typeof(CookieAuthenticationMiddleware), app, options) 方法，将CookieAuthenticationMiddleware 中间件注册到OWIN Pipeline中</span></li>
<li><span style="font-size: 15px;">通过app.UseStageMarker(PipelineStage.Authenticate)方法，将前面添加的CookieAuthenticationMiddleware指定在 ASP.NET 集成管道（ASP.NET integrated pipeline）的AuthenticateRequest阶段执行</span></li>
</ul>
<p><span style="font-size: 15px;">当调用（Invoke）此Middleware时，将调用CreateHandler方法返回CookieAuthenticationHandler对象，它包含 AuthenticateCoreAsync方法，在这个方法中，读取并且验证Cookie，然后通过AddUserIdentity方法创建ClaimsPrincipal对象并添加到Owin环境字典中，可以通过OwinContext对象Request.User可以获取当前用户。</span></p>
<p><span style="font-size: 15px;">这是一个典型Middleware中间件使用场景，说白了就是去处理Http请求并将数据存储到OWIN环境字典中进行传递。而CookieAuthenticationMiddleware所做的事其实和FormsAuthenticationModule做的事类似。</span></p>
<p><span style="font-size: 15px;">那我们怎么产生Cookie呢？使用ASP.NET Identity 进行身份验证，如果验证通过，产生Cookie并输出到客户端浏览器， 这样一个闭环就形成了，我将在下一小节实施这一步骤。</span></p>
<p><span style="font-size: 15px;"><strong>3.使用Authorize特性进行授权 </strong></span></p>
<p><span style="font-size: 15px;">ASP.NET Identity已经集成到了ASP.NET Framework中，在ASP.NET MVC 中，我们可以使用Authorize 特性进行授权，如下代码所示：</span></p>
<ol>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">[Authorize] </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;"><span style="color: blue;">public</span> ActionResult Index() </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">return</span> View(); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">} </span></div>
</li>
</ol>
<p><span style="font-size: 15px;">上述代码中，Index Action 已被设置了受限访问，只有身份验证通过才能访问它，如果验证不通过，返回401.0 – Unauthorized，然后请求在EndRequest 阶段被 OWIN Authentication Middleware 处理，302 重定向到/Account/Login 登录。</span></p>
<p><span style="font-size: 15px;"><img src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/299214-20150906223800951-1475013413.png" alt=""></span></p>
<div style="text-align: right"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#_labelTop">回到顶部</a><a name="_label1"></a></div><h3><span style="font-size: 15px;">使用ASP.NET Identity 身份验证</span></h3>
<p><span style="font-size: 15px;">有了对身份验证和授权机制基本了解后，那么现在就该使用ASP.NET Identity 进行身份验证了。</span></p>
<p><span style="font-size: 15px;"><strong>1. 实现身份验证所需的准备工作 </strong></span></p>
<p><span style="font-size: 15px;">当我们匿名访问授权资源时，会被Redirect 到 /Account/Login 时，此时的URL结构如下：</span></p>
<p><span style="font-size: 15px;"><strong>http://localhost:60533/Account/Login?ReturnUrl=%2Fhome%2Findex </strong></span></p>
<p><span style="font-size: 15px;">因为需要登陆，所以可以将Login 设置为允许匿名登陆，只需要在Action的上面添加 <strong>[AllowAnonymous]</strong> 特性标签，如下所示：</span></p>
<ol>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">[AllowAnonymous] </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;"><span style="color: blue;">public</span> ActionResult Login(<span style="color: blue;">string</span> returnUrl) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">//如果登录用户已经Authenticated，提示请勿重复登<span style="font-family: 宋体;">录</span></span> </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">if</span> (HttpContext.User.Identity.IsAuthenticated) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">return</span> View("<span style="color: darkred;">Error</span>", <span style="color: blue;">new</span> <span style="color: blue;">string</span>[] {"<span style="color: darkred;">您已经登录！</span>"}); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;ViewBag.returnUrl = returnUrl; </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">return</span> View(); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">} </span></div>
</li>
</ol>
<p><span style="font-size: 15px;">注意，在这儿我将ReturnUrl 存储了起来，ReturnUrl 顾名思义，当登录成功后，重定向到最初的地址，这样提高了用户体验。</span></p>
<p><span style="font-size: 15px;">由于篇幅的限制，Login View 我不将代码贴出来了，事实上它也非常简单，包含如下内容:</span></p>
<ul>
<li><span style="font-size: 15px;">用户名文本框</span></li>
<li><span style="font-size: 15px;">密码框</span></li>
<li><span style="font-size: 15px;">存储ReturnUrl的隐藏域</span></li>
<li><span style="font-size: 15px;">@Html.AntiForgeryToken()，用来防止CSRF跨站请求伪造</span></li>
</ul>
<p><span style="font-size: 15px;"><strong>2.添加用户并实现身份验证 </strong></span></p>
<p><span style="font-size: 15px;">当输入了凭据之后，POST Form 表单到/Account/Login 下，具体代码如下：</span></p>
<ol>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">[HttpPost] </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">[AllowAnonymous] </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">[ValidateAntiForgeryToken] </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;"><span style="color: blue;">public</span> async Task&lt;ActionResult&gt; Login(LoginModel model,<span style="color: blue;">string</span> returnUrl) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">if</span> (ModelState.IsValid) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AppUser user = await UserManager.FindAsync(model.Name, model.Password); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">if</span> (user==<span style="color: blue;">null</span>) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ModelState.AddModelError("","<span style="color: darkred;">无效的用户名或密码</span>"); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">else</span> </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var claimsIdentity = </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;await UserManager.CreateIdentityAsync(user, DefaultAuthenticationTypes.ApplicationCookie); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AuthManager.SignOut(); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AuthManager.SignIn(<span style="color: blue;">new</span> AuthenticationProperties {IsPersistent = <span style="color: blue;">false</span>}, claimsIdentity); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">return</span> Redirect(returnUrl); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;ViewBag.returnUrl = returnUrl; </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;</span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">return</span> View(model); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">} </span></div>
</li>
</ol>
<p><span style="font-size: 15px;">上述代码中，首先使用 ASP.NET Identity 来验证用户凭据，这是通过 AppUserManager 对象的FindAsync 方法来实现，如果你不了解ASP.NET Identity 基本API ，请参考我<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-get-started-with-identity.html">这篇文章</a>。</span></p>
<ol>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">AppUser user = await UserManager.FindAsync(model.Name, model.Password); </span></div>
</li>
</ol>
<p><span style="font-size: 15px;">FindAsync 方法接受两个参数，分别是用户名和密码，如果查找到，则返回AppUser 对象，否则返回NULL。</span></p>
<p><span style="font-size: 15px;">如果FindAsync 方法返回AppUser 对象，那么接下来就是创建Cookie 并输出到客户端浏览器，这样浏览器的下一次请求就会带着这个Cookie，当请求经过AuthenticateRequest 阶段时，读取并解析Cookie。也就是说Cookie 就是我们的令牌， Cookie如本人，我们不必再进行用户名和密码的验证了。</span></p>
<p><span style="font-size: 15px;">使用ASP.NET Identity 产生Cookie 其实很简单，就3行代码，如下所示：</span></p>
<ol>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">var claimsIdentity = </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;await UserManager.CreateIdentityAsync(user, DefaultAuthenticationTypes.ApplicationCookie); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">AuthManager.SignOut(); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">AuthManager.SignIn(<span style="color: blue;">new</span> AuthenticationProperties {IsPersistent = <span style="color: blue;">false</span>}, claimsIdentity); </span></div>
</li>
</ol>
<p><span style="font-size: 15px;">对代码稍作分析，第一步创建了用来代表当前登录用户的<strong>ClaimsIdentity</strong> 对象，ClaimsIndentity 是 ASP.NET Identity 中的类，它实现了IIdentity 接口。</span></p>
<p><span style="font-size: 15px;">ClaimsIdentity 对象实际上由AppUserManager 对象的CreateIdentityAsync 方法创建，它需要接受一个AppUser 对象和身份验证类型，在这儿选择ApplicationCookie。</span></p>
<p><span style="font-size: 15px;">接下来，就是让已存在的Cookie 失效，并产生新Cookie。我预先定义了一个AuthManager 属性，它是IAuthenticationManager 类型的对象，用来做一些通用的身份验证操作。它 包含如下重要的操作：</span></p>
<ul>
<li><span style="font-size: 15px;">SignIn(options，identity) 故名思意登录，用来产生身份验证过后的Cookie</span></li>
<li><span style="font-size: 15px;">SignOut() 故名思意登出，让已存在的Cookie 失效</span></li>
</ul>
<p><span style="font-size: 15px;">SignIn 需要接受两个参数，AuthenticationProperties 对象和ClaimsIdentity 对象，AuthticationProperties 有众多属性，我在这儿只设置<span style="color: black; font-family: 微软雅黑; background-color: white;">IsPersistent=</span>true ，意味着Authentication Session 被持久化保存，当开启新Session 时，该用户不必重新验证了。</span></p>
<p><span style="font-size: 15px;">最后，重定向到ReturnUrl:</span></p>
<ol>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;"><span style="color: blue;">return</span> Redirect(returnUrl); </span></div>
</li>
</ol>
<div style="text-align: right"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#_labelTop">回到顶部</a><a name="_label2"></a></div><h3><span style="font-size: 15px;">使用角色进行授权</span></h3>
<p><span style="font-size: 15px;">在前一小节中，使用了Authorize 特性对指定区域进行受限访问，只有被身份验证通过后才能继续访问。在这一小节将更细粒度进行授权操作，在ASP.NET MVC Framework 中，Authorize 往往结合User 或者 Role 属性进行更小粒度的授权操作，正如如下代码所示：</span></p>
<ol>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">[Authorize(Roles = "<span style="color: darkred;">Administrator</span>")] </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;"><span style="color: blue;">public</span> <span style="color: blue;">class</span> RoleController : Controller </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">} </span></div>
</li>
</ol>
<p><span style="font-size: 15px;"><strong>1.使用ASP.NET Identity 管理角色 </strong></span></p>
<p><span style="font-size: 15px;">对Authorize 有了基本的了解之后，将关注点转移到角色Role的管理上来。ASP.NET Identity 提供了一个名为RoleManager&lt;T&gt; 强类型基类用来访问和管理角色，其中T 实现了IRole 接口，IRole 接口包含了持久化Role 最基础的字段（Id和Name）。</span></p>
<p><span style="font-size: 15px;">Entity Framework 提供了名为IdentityRole 的类，它实现了IRole 接口，所以它不仅包含Id、Name属性，还增加了一个集合属性Users。IdentityRole重要的属性如下所示：</span></p>
<div>
<table style="border-collapse: collapse; height: 133px; width: 926px;" border="0"><colgroup><col style="width: 288px;"><col style="width: 288px;"></colgroup>
<tbody valign="top">
<tr>
<td style="padding-left: 7px; padding-right: 7px; border: solid 0.5pt;">
<p><span style="font-size: 15px;">Id</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: solid 0.5pt; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">定义了Role 唯一的Id</span></p>
</td>
</tr>
<tr>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid 0.5pt; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">Name</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">定义了Role的名称</span></p>
</td>
</tr>
<tr>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid 0.5pt; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">Users</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">返回隶属于Role的所有成员</span></p>
</td>
</tr>
</tbody>
</table>
</div>
<p><span style="font-size: 15px;">&nbsp;</span></p>
<p><span style="font-size: 15px;">我不想在应用程序中直接使用IdentityRole，因为我们还可能要去扩展其他字段，故定义一个名为AppRole的类，就像AppUser那样，它继承自IdentityRole：</span></p>
<ol>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;"><span style="color: blue;">public</span> <span style="color: blue;">class</span> AppRole:IdentityRole </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">public</span> AppRole() : <span style="color: blue;">base</span>() { } </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">public</span> AppRole(<span style="color: blue;">string</span> name) : <span style="color: blue;">base</span>(name) { } </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">// 在此添加额外属<span style="font-family: 宋体;">性</span></span> </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">} </span></div>
</li>
</ol>
<p><span style="font-size: 15px;">同时，再定义一个AppRoleManager 类，如同AppUserManager 一样，它继承RoleManager&lt;T&gt;，提供了检索和持久化Role的基本方法:</span></p>
<ol>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;"><span style="color: blue;">public</span> <span style="color: blue;">class</span> AppRoleManager:RoleManager&lt;AppRole&gt; </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">public</span> AppRoleManager(RoleStore&lt;AppRole&gt; store):<span style="color: blue;">base</span>(store) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;</span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">public</span> <span style="color: blue;">static</span> AppRoleManager Create(IdentityFactoryOptions&lt;AppRoleManager&gt; options, IOwinContext context) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">return</span> <span style="color: blue;">new</span> AppRoleManager(<span style="color: blue;">new</span> RoleStore&lt;AppRole&gt;(context.Get&lt;AppIdentityDbContext&gt;())); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">} </span></div>
</li>
</ol>
<p><span style="font-size: 15px;">最后，别忘了在OWIN Startup类中初始化该实例，它将存储在OWIN上下文环境字典中，贯穿了每一次HTTP请求:</span></p>
<ol>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">app.CreatePerOwinContext(AppIdentityDbContext.Create); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">app.CreatePerOwinContext&lt;AppUserManager&gt;(AppUserManager.Create); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">app.CreatePerOwinContext&lt;AppRoleManager&gt;(AppRoleManager.Create); </span></div>
</li>
</ol>
<p><span style="font-size: 15px;"><strong>2.创建和删除角色 </strong></span></p>
<p><span style="font-size: 15px;">使用ASP.NET Identity 创建和删除角色很简单，通过从OWIN 上下文中获取到AppRoleManager，然后Create 或者 Delete，如下所示：</span></p>
<ol>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">[HttpPost] </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;"><span style="color: blue;">public</span> async Task&lt;ActionResult&gt; Create(<span style="color: blue;">string</span> name) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">if</span> (ModelState.IsValid) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IdentityResult result = await RoleManager.CreateAsync(<span style="color: blue;">new</span> AppRole(name)); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">if</span> (result.Succeeded) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">return</span> RedirectToAction("<span style="color: darkred;">Index</span>"); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">else</span> </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddErrorsFromResult(result); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">return</span> View(name); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;</span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">[HttpPost] </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;"><span style="color: blue;">public</span> async Task&lt;ActionResult&gt; Delete(<span style="color: blue;">string</span> id) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;AppRole role = await RoleManager.FindByIdAsync(id); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">if</span> (role != <span style="color: blue;">null</span>) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IdentityResult result = await RoleManager.DeleteAsync(role); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">if</span> (result.Succeeded) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">return</span> RedirectToAction("<span style="color: darkred;">Index</span>"); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">else</span> </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">return</span> View("<span style="color: darkred;">Error</span>", result.Errors); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">else</span> </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">return</span> View("<span style="color: darkred;">Error</span>", <span style="color: blue;">new</span> <span style="color: blue;">string</span>[] { "<span style="color: darkred;">无法找到该Role</span>" }); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">} </span></div>
</li>
</ol>
<p><span style="font-size: 15px;"><strong>3.管理角色 MemberShip </strong></span></p>
<p><span style="font-size: 15px;">要对用户授权，除了创建和删除角色之外，还需要对角色的MemberShip 进行管理，即通过Add /Remove 操作，可以向用户添加/删除角色。</span></p>
<p><span style="font-size: 15px;">为此，我添加了两个ViewModel，RoleEditModel和RoleModificationModel，分别代表编辑时展示字段和表单 Post时传递到后台的字段：</span></p>
<ol>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;"><span style="color: blue;">public</span> <span style="color: blue;">class</span> RoleEditModel </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">public</span> AppRole Role { <span style="color: blue;">get</span>; <span style="color: blue;">set</span>; } </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">public</span> IEnumerable&lt;AppUser&gt; Members { <span style="color: blue;">get</span>; <span style="color: blue;">set</span>; } </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">public</span> IEnumerable&lt;AppUser&gt; NonMembers { <span style="color: blue;">get</span>; <span style="color: blue;">set</span>; } </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;"><span style="color: blue;">public</span> <span style="color: blue;">class</span> RoleModificationModel </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">public</span> <span style="color: blue;">string</span> RoleName { <span style="color: blue;">get</span>; <span style="color: blue;">set</span>; } </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">public</span> <span style="color: blue;">string</span>[] IDsToAdd { <span style="color: blue;">get</span>; <span style="color: blue;">set</span>; } </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">public</span> <span style="color: blue;">string</span>[] IDsToDelete { <span style="color: blue;">get</span>; <span style="color: blue;">set</span>; } </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">} </span></div>
</li>
</ol>
<p><span style="font-size: 15px;">在对角色进行编辑时，获取所有隶属于Role的成员和非隶属于Role的成员：</span></p>
<ol>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;"><span style="color: gray;">/// &lt;summary&gt;</span> </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;"><span style="color: gray;">/// 编辑操作，获取所有隶属于此Role的成员和非隶属于此Role的成<span style="font-family: 宋体;">员</span></span> </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;"><span style="color: gray;">/// &lt;/summary&gt;</span> </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;"><span style="color: gray;">/// &lt;param name="id"&gt;&lt;/param&gt;</span> </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;"><span style="color: gray;">/// &lt;returns&gt;&lt;/returns&gt;</span> </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;"><span style="color: blue;">public</span> async Task&lt;ActionResult&gt; Edit(<span style="color: blue;">string</span> id) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;AppRole role = await RoleManager.FindByIdAsync(id); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">string</span>[] memberIDs = role.Users.Select(x =&gt; x.UserId).ToArray(); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;IEnumerable&lt;AppUser&gt; members = UserManager.Users.Where(x =&gt; memberIDs.Any(y =&gt; y == x.Id)); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;IEnumerable&lt;AppUser&gt; nonMembers = UserManager.Users.Except(members); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">return</span> View(<span style="color: blue;">new</span> RoleEditModel() </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Role = role, </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Members = members, </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NonMembers = nonMembers </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;}); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">} </span></div>
</li>
</ol>
<p><span style="font-size: 15px;">最终呈现的视图如下所示：</span></p>
<p><span style="font-size: 15px;"><img src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/299214-20150906223801545-1927281996.png" alt=""></span></p>
<p><span style="font-size: 15px;">当点击保存，提交表单时，通过模型绑定，将数据Post 到Edit Action，实现了对角色的MemberShip 进行管理，即通过Add /Remove 操作，可以向用户添加/删除角色。</span></p>
<p><span style="font-size: 15px;">，如下所示：</span></p>
<ol>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">[HttpPost] </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;"><span style="color: blue;">public</span> async Task&lt;ActionResult&gt; Edit(RoleModificationModel model) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;IdentityResult result; </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">if</span> (ModelState.IsValid) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">foreach</span> (<span style="color: blue;">string</span> userId <span style="color: blue;">in</span> model.IDsToAdd??<span style="color: blue;">new</span> <span style="color: blue;">string</span>[] {}) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result = await UserManager.AddToRoleAsync(userId, model.RoleName); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">if</span> (!result.Succeeded) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">return</span> View("<span style="color: darkred;">Error</span>", result.Errors); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">foreach</span> (var userId <span style="color: blue;">in</span> model.IDsToDelete??<span style="color: blue;">new</span> <span style="color: blue;">string</span>[] {}) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result = await UserManager.RemoveFromRoleAsync(userId, model.RoleName); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">if</span> (!result.Succeeded) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">return</span> View("<span style="color: darkred;">Error</span>", result.Errors); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">return</span> RedirectToAction("<span style="color: darkred;">Index</span>"); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">return</span> View("<span style="color: darkred;">Error</span>",<span style="color: blue;">new</span> <span style="color: blue;">string</span>[] {"<span style="color: darkred;">无法找到此角色</span>"}); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">} </span></div>
</li>
</ol>
<p><span style="font-size: 15px;">在上述代码中，你可能注意到了UserManager 类，它包含了若干与角色相关的操作方法：</span></p>
<div>
<table style="border-collapse: collapse; height: 218px; width: 924px;" border="0"><colgroup><col style="width: 312px;"><col style="width: 264px;"></colgroup>
<tbody valign="top">
<tr>
<td style="padding-left: 7px; padding-right: 7px; border: solid 0.5pt;">
<p><span style="color: black; font-family: 微软雅黑; font-size: 15px;"><span style="background-color: white;">AddToRoleAsync</span>(string userId,string role)</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: solid 0.5pt; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">添加用户到指定的角色中</span></p>
</td>
</tr>
<tr>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid 0.5pt; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="color: black; font-family: 微软雅黑; font-size: 15px;"><span style="background-color: white;">GetRolesAsync</span>(string userId)</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">获取User对应的角色列表</span></p>
</td>
</tr>
<tr>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid 0.5pt; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="color: black; font-family: 微软雅黑; font-size: 15px;"><span style="background-color: white;">IsInRoleAsync</span>(string userId,string role)</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">判断用户是否隶属于指定的角色</span></p>
</td>
</tr>
<tr>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid 0.5pt; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="color: black; font-family: 微软雅黑; font-size: 15px;"><span style="background-color: white;">RemoveFromRoleAsync</span>(string userId,string role)</span></p>
</td>
<td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid 0.5pt; border-right: solid 0.5pt;">
<p><span style="font-size: 15px;">将用户从指定角色中排除</span></p>
</td>
</tr>
</tbody>
</table>
</div>
<p><span style="font-size: 15px;">&nbsp;</span></p>
<div style="text-align: right"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#_labelTop">回到顶部</a><a name="_label3"></a></div><h3><span style="font-size: 15px;">初始化数据，Seeding 数据库</span></h3>
<p><span style="font-size: 15px;">在上一小节中，通过Authorize 标签将Role 控制器受限访问，只有Role=Administrator的用户才能访问和操作。</span></p>
<ol>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">[Authorize(Roles = "<span style="color: darkred;">Administrator</span>")] </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;"><span style="color: blue;">public</span> <span style="color: blue;">class</span> RoleController : Controller </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">} </span></div>
</li>
</ol>
<p><span style="font-size: 15px;">但当我们的应用程序部署到新环境时，是没有具体的用户数据的，这就导致我们无法访问Role Controller。这是一个典型的 "鸡生蛋还是蛋生鸡"问题。</span></p>
<p><span style="font-size: 15px;">要解决这个问题，我们一般是在数据库中内置一个管理员角色，这也是我们熟知的超级管理员角色。通过Entity Framework Seed，我们可以轻松实现数据的初始化：</span></p>
<ol>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;"><span style="color: blue;">public</span> <span style="color: blue;">class</span> IdentityDbInit </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;: DropCreateDatabaseIfModelChanges&lt;AppIdentityDbContext&gt; </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">protected</span> <span style="color: blue;">override</span> <span style="color: blue;">void</span> Seed(AppIdentityDbContext context) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PerformInitialSetup(context); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">base</span>.Seed(context); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;</span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">public</span> <span style="color: blue;">void</span> PerformInitialSetup(AppIdentityDbContext context) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">// 初始<span style="font-family: 宋体;">化</span></span> </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AppUserManager userMgr = <span style="color: blue;">new</span> AppUserManager(<span style="color: blue;">new</span> UserStore&lt;AppUser&gt;(context)); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AppRoleManager roleMgr = <span style="color: blue;">new</span> AppRoleManager(<span style="color: blue;">new</span> RoleStore&lt;AppRole&gt;(context)); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;</span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">string</span> roleName = "<span style="color: darkred;">Administrators</span>"; </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">string</span> userName = "<span style="color: darkred;">Admin</span>"; </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">string</span> password = "<span style="color: darkred;">Password2015</span>"; </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">string</span> email = "<span style="color: darkred;">admin@jkxy.com</span>"; </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;</span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">if</span> (!roleMgr.RoleExists(roleName)) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;roleMgr.Create(<span style="color: blue;">new</span> AppRole(roleName)); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;</span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AppUser user = userMgr.FindByName(userName); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">if</span> (user == <span style="color: blue;">null</span>) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;userMgr.Create(<span style="color: blue;">new</span> AppUser { UserName = userName, Email = email }, </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;password); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user = userMgr.FindByName(userName); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;</span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">if</span> (!userMgr.IsInRole(user.Id, roleName)) </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;userMgr.AddToRole(user.Id, roleName); </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">&nbsp;&nbsp;&nbsp;&nbsp;} </span></div>
</li>
<li>
<div style="background: #f4f4f4;"><span style="font-size: 15px;">} </span></div>
</li>
</ol>
<p><span style="font-size: 15px;">在这儿实例化了AppUserManager和AppRoleManager实例，这是因为PerformInitialSetup 方法比OWIN 配置先执行。</span></p>
<div style="text-align: right"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#_labelTop">回到顶部</a><a name="_label4"></a></div><h3><span style="font-size: 15px;">小结</span></h3>
<blockquote>
<p><span style="font-size: 15px;">在这篇文章中，探索了使用ASP.NET Identity 进行身份验证以及联合ASP.NET MVC 基于角色的授权。最后实现了对角色的管理。在下一篇文章中，继续ASP.NET Identity之旅，探索ASP.NET Identity 的高级应用——基于声明的授权。</span></p>
</blockquote></div><div id="MySignature" style="display: block;"> <fieldset style="background-color:#ffffa0; font-family:微软雅黑; font-size:15px;color:Black; width:650px;">
  <legend><a href="http://creativecommons.org/licenses/by/2.5/cn/"><img src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/88x31.png"></a></legend>
<div style=" border-style:dotted;">
本博客为<a href="http://www.cnblogs.com/OceanEyes/p/www.cnblogs.com/oceaneyes" target="_blank">木宛城主</a>原创，基于<a href="http://creativecommons.org/licenses/by/2.5/cn/">Creative Commons Attribution 2.5 China Mainland License</a>发布，欢迎转载，演绎或用于商业目的，但是必须保留本文的署名<a href="http://www.cnblogs.com/OceanEyes/p/www.cnblogs.com/oceaneyes" target="_blank">木宛城主</a>（包含链接）。如您有任何疑问或者授权方面的协商，请给我留言。
</div>
</fieldset></div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="BlogPostCategory">分类: <a href="http://www.cnblogs.com/OceanEyes/category/393525.html" target="_blank">ASP.NET MVC</a>,<a href="http://www.cnblogs.com/OceanEyes/category/696137.html" target="_blank">ASP.NET MVC 随想录</a></div>
<div id="EntryTag"></div>
<div id="blog_post_info"><div id="green_channel">
        <a href="javascript:void(0);" id="green_channel_digg" onclick="DiggIt(4787576,cb_blogId,1);green_channel_success(this,&#39;谢谢推荐！&#39;);">好文要顶</a>
            <a id="green_channel_follow" onclick="follow(&#39;7d9cc6a0-df7a-e011-a53f-842b2b196315&#39;);" href="javascript:void(0);">关注我</a>
    <a id="green_channel_favorite" onclick="AddToWz(cb_entryId);return false;" href="javascript:void(0);">收藏该文</a>
    <a id="green_channel_weibo" href="javascript:void(0);" title="分享至新浪微博" onclick="ShareToTsina()"><img src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/icon_weibo_24.png" alt=""></a>
    <a id="green_channel_wechat" href="javascript:void(0);" title="分享至微信" onclick="shareOnWechat()"><img src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/wechat.png" alt=""></a>
</div>
<div id="author_profile">
    <div id="author_profile_info" class="author_profile_info">
            <a href="http://home.cnblogs.com/u/OceanEyes/" target="_blank"><img src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/20150329043854.png" class="author_avatar" alt=""></a>
        <div id="author_profile_detail" class="author_profile_info">
            <a href="http://home.cnblogs.com/u/OceanEyes/">木宛城主</a><br>
            <a href="http://home.cnblogs.com/u/OceanEyes/followees">关注 - 0</a><br>
            <a href="http://home.cnblogs.com/u/OceanEyes/followers">粉丝 - 1454</a>
        </div>
    </div>
    <div class="clear"></div>
    <div id="author_profile_honor">荣誉：<a href="http://www.cnblogs.com/expert/" target="_blank">推荐博客</a></div>
    <div id="author_profile_follow">
                <a href="javascript:void(0);" onclick="follow(&#39;7d9cc6a0-df7a-e011-a53f-842b2b196315&#39;);return false;">+加关注</a>
    </div>
</div>
<div id="div_digg"><div style="padding-bottom: 5px"><span class="icon_favorite" style="padding-top: 2px; padding-bottom: 2px"></span><a onclick="follow(&#39;7d9cc6a0-df7a-e011-a53f-842b2b196315&#39;);" href="javascript:void(0);" style="font-weight: bold; padding-left: 5px;">关注木宛城主</a></div>
    <div class="diggit" onclick="votePost(4787576,&#39;Digg&#39;)">
        <span class="diggnum" id="digg_count">61</span>
    </div>
    <div class="buryit" onclick="votePost(4787576,&#39;Bury&#39;)">
        <span class="burynum" id="bury_count">0</span>
    </div>
    <div class="clear"></div>
    <div class="diggword" id="digg_tips">
    </div>
</div>
</div>
<div class="clear"></div>
<div id="post_next_prev"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-get-started-with-identity.html" class="p_n_p_prefix">« </a> 上一篇：<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-get-started-with-identity.html" title="发布于2015-08-05 00:35">ASP.NET MVC 随想录——开始使用ASP.NET Identity，初级篇</a><br><a href="http://www.cnblogs.com/OceanEyes/p/asp-net-identity-claim-based-authorization.html" class="p_n_p_prefix">» </a> 下一篇：<a href="http://www.cnblogs.com/OceanEyes/p/asp-net-identity-claim-based-authorization.html" title="发布于2015-09-26 06:49">ASP.NET MVC 随想录——  使用ASP.NET Identity实现基于声明的授权，高级篇</a><br></div>
</div>


		</div>
		<div class="postDesc">posted @ <span id="post-date">2015-09-06 22:54</span> <a href="http://www.cnblogs.com/OceanEyes/">木宛城主</a> 阅读(<span id="post_view_count">16051</span>) 评论(<span id="post_comment_count">38</span>)  <a href="https://i.cnblogs.com/EditPosts.aspx?postid=4787576" rel="nofollow">编辑</a> <a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#" onclick="AddToWz(4787576);return false;">收藏</a></div>
	</div>
	<script type="text/javascript">var allowComments=true,cb_blogId=88841,cb_entryId=4787576,cb_blogApp=currentBlogApp,cb_blogUserGuid='7d9cc6a0-df7a-e011-a53f-842b2b196315',cb_entryCreatedDate='2015/9/6 22:54:00';loadViewCount(cb_entryId);</script>
	
</div><!--end: topics 文章、评论容器-->
</div><a name="!comments"></a><div id="blog-comments-placeholder"><div id="comments_pager_top"></div>
<!--done-->
<div class="feedback_area_title">评论列表</div>
<div class="feedbackNoItems"></div>
	

		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261245" class="layer">#1楼</a><a name="3261245" id="comment_anchor_3261245"></a>  <span class="comment_date">2015-09-07 00:27</span> <a id="a_comment_author_3261245" href="http://www.cnblogs.com/boyliupan/" target="_blank">圣光下的囚徒</a> <a href="http://msg.cnblogs.com/send/%E5%9C%A3%E5%85%89%E4%B8%8B%E7%9A%84%E5%9B%9A%E5%BE%92" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261245" class="blog_comment_body">[Authorize(Roles = "Administrator")]这里方法的角色权限这些写是不是太死了，如果通过程序添加新的角色，怎么动态鉴权，求教</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261245,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261245,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261245_avatar" style="display:none;">http://pic.cnblogs.com/face/30693/20130614180912.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261248" class="layer">#2楼</a><a name="3261248" id="comment_anchor_3261248"></a>  <span class="comment_date">2015-09-07 00:31</span> <a id="a_comment_author_3261248" href="http://www.cnblogs.com/fej121/" target="_blank">文楚</a> <a href="http://msg.cnblogs.com/send/%E6%96%87%E6%A5%9A" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261248" class="blog_comment_body">对于管理员初始化的问题，我看国外文章基本都在migration config里的seed里设置一次即可，不用自己搞一个DropCreateDatabaseIfModelChanges了。还有希望楼主讲讲这个claim具体该怎么使用？</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261248,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261248,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261248_avatar" style="display:none;">http://pic.cnblogs.com/face/28457/20141210231443.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261249" class="layer">#3楼</a><a name="3261249" id="comment_anchor_3261249"></a>  <span class="comment_date">2015-09-07 00:32</span> <a id="a_comment_author_3261249" href="http://www.cnblogs.com/guomingfeng/" target="_blank">郭明锋</a> <a href="http://msg.cnblogs.com/send/%E9%83%AD%E6%98%8E%E9%94%8B" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261249" class="blog_comment_body">支持城主，不过建议把代码的#cnblogs_post_body ol样式的max-height去掉，否则读文章的时候阅读代码真是极其不方便</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261249,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261249,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261249_avatar" style="display:none;">http://pic.cnblogs.com/face/u87201.jpg</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261271" class="layer">#4楼</a><a name="3261271" id="comment_anchor_3261271"></a>  <span class="comment_date">2015-09-07 08:13</span> <a id="a_comment_author_3261271" href="http://www.cnblogs.com/sunjie9606/" target="_blank">sunjie</a> <a href="http://msg.cnblogs.com/send/sunjie" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261271" class="blog_comment_body">mark</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261271,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261271,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261317" class="layer">#5楼</a><a name="3261317" id="comment_anchor_3261317"></a>[<span class="louzhu">楼主</span>]  <span class="comment_date">2015-09-07 09:13</span> <a id="a_comment_author_3261317" href="http://www.cnblogs.com/OceanEyes/" target="_blank">木宛城主</a> <a href="http://msg.cnblogs.com/send/%E6%9C%A8%E5%AE%9B%E5%9F%8E%E4%B8%BB" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261317" class="blog_comment_body"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261248" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3261248);">@</a>
文楚<br>对的，我没做Migration</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261317,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261317,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261317_avatar" style="display:none;">http://pic.cnblogs.com/face/299214/20150329043854.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261320" class="layer">#6楼</a><a name="3261320" id="comment_anchor_3261320"></a>[<span class="louzhu">楼主</span>]  <span class="comment_date">2015-09-07 09:14</span> <a id="a_comment_author_3261320" href="http://www.cnblogs.com/OceanEyes/" target="_blank">木宛城主</a> <a href="http://msg.cnblogs.com/send/%E6%9C%A8%E5%AE%9B%E5%9F%8E%E4%B8%BB" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261320" class="blog_comment_body"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261249" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3261249);">@</a>
郭明锋<br>哈哈，我主要是考虑贴太多代码会导致篇幅过长，我改下字体大小试试。</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261320,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261320,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261320_avatar" style="display:none;">http://pic.cnblogs.com/face/299214/20150329043854.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261326" class="layer">#7楼</a><a name="3261326" id="comment_anchor_3261326"></a>[<span class="louzhu">楼主</span>]  <span class="comment_date">2015-09-07 09:16</span> <a id="a_comment_author_3261326" href="http://www.cnblogs.com/OceanEyes/" target="_blank">木宛城主</a> <a href="http://msg.cnblogs.com/send/%E6%9C%A8%E5%AE%9B%E5%9F%8E%E4%B8%BB" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261326" class="blog_comment_body"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261245" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3261245);">@</a>
牧 童<br>应该是可以的，自定义一个Filter</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261326,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261326,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261326_avatar" style="display:none;">http://pic.cnblogs.com/face/299214/20150329043854.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261362" class="layer">#8楼</a><a name="3261362" id="comment_anchor_3261362"></a>  <span class="comment_date">2015-09-07 09:38</span> <a id="a_comment_author_3261362" href="http://www.cnblogs.com/fenglingyi/" target="_blank">枫伶忆</a> <a href="http://msg.cnblogs.com/send/%E6%9E%AB%E4%BC%B6%E5%BF%86" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261362" class="blog_comment_body">城主发现你这css博客样式挺好的，打算借用下，能否？</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261362,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261362,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261362_avatar" style="display:none;">http://pic.cnblogs.com/face/712650/20150225110751.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261364" class="layer">#9楼</a><a name="3261364" id="comment_anchor_3261364"></a>[<span class="louzhu">楼主</span>]  <span class="comment_date">2015-09-07 09:39</span> <a id="a_comment_author_3261364" href="http://www.cnblogs.com/OceanEyes/" target="_blank">木宛城主</a> <a href="http://msg.cnblogs.com/send/%E6%9C%A8%E5%AE%9B%E5%9F%8E%E4%B8%BB" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261364" class="blog_comment_body"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261362" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3261362);">@</a>
枫伶忆<br>用吧，随意。我也是参考别人的：）</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261364,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261364,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261364_avatar" style="display:none;">http://pic.cnblogs.com/face/299214/20150329043854.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261453" class="layer">#10楼</a><a name="3261453" id="comment_anchor_3261453"></a>  <span class="comment_date">2015-09-07 10:50</span> <a id="a_comment_author_3261453" href="http://www.cnblogs.com/guomingfeng/" target="_blank">郭明锋</a> <a href="http://msg.cnblogs.com/send/%E9%83%AD%E6%98%8E%E9%94%8B" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261453" class="blog_comment_body"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261320" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3261320);">@</a>
木宛城主<br><fieldset class="comment_quote"><legend><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261320" title="查看引用原文">引用</a></legend>@郭明锋<br>哈哈，我主要是考虑贴太多代码会导致篇幅过长，我改下字体大小试试。</fieldset><br>我觉得篇幅的问题不是问题，阅读代码，经常是要回头看代码的前半部分的，比如回头看变量的定义，初始化等，基本上回头看前半部分的代码频率是很高的，弄个滚动条都是要去滚动，不能一目了然，我觉得是很累的，@Artech的文章也有这个问题，不过我跟他提了他没鸟，每次看这种文章都挺烦的。当然，这仅仅是个人感觉，个人感觉</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261453,&#39;Digg&#39;,this)">支持(2)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261453,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261453_avatar" style="display:none;">http://pic.cnblogs.com/face/u87201.jpg</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261455" class="layer">#11楼</a><a name="3261455" id="comment_anchor_3261455"></a>  <span class="comment_date">2015-09-07 10:52</span> <a id="a_comment_author_3261455" href="http://www.cnblogs.com/xishuai/" target="_blank">田园里的蟋蟀</a> <a href="http://msg.cnblogs.com/send/%E7%94%B0%E5%9B%AD%E9%87%8C%E7%9A%84%E8%9F%8B%E8%9F%80" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261455" class="blog_comment_body">赞！正好学习下！</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261455,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261455,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261455_avatar" style="display:none;">http://pic.cnblogs.com/face/435188/20130715165802.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261461" class="layer">#12楼</a><a name="3261461" id="comment_anchor_3261461"></a>  <span class="comment_date">2015-09-07 10:59</span> <a id="a_comment_author_3261461" href="http://www.cnblogs.com/newton/" target="_blank">莱布尼茨</a> <a href="http://msg.cnblogs.com/send/%E8%8E%B1%E5%B8%83%E5%B0%BC%E8%8C%A8" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261461" class="blog_comment_body">微软的这套用户验证体系一直没搞明白，有时间要系统学习下！</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261461,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261461,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261461_avatar" style="display:none;">http://pic.cnblogs.com/face/474041/20130222025701.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261475" class="layer">#13楼</a><a name="3261475" id="comment_anchor_3261475"></a>  <span class="comment_date">2015-09-07 11:08</span> <a id="a_comment_author_3261475" href="http://www.cnblogs.com/AaronYang/" target="_blank">AYUI框架</a> <a href="http://msg.cnblogs.com/send/AYUI%E6%A1%86%E6%9E%B6" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261475" class="blog_comment_body">一定看</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261475,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261475,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261475_avatar" style="display:none;">http://pic.cnblogs.com/face/377862/20170103165727.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261492" class="layer">#14楼</a><a name="3261492" id="comment_anchor_3261492"></a>  <span class="comment_date">2015-09-07 11:16</span> <a id="a_comment_author_3261492" href="http://www.cnblogs.com/ycbt/" target="_blank">搵中求胜</a> <a href="http://msg.cnblogs.com/send/%E6%90%B5%E4%B8%AD%E6%B1%82%E8%83%9C" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261492" class="blog_comment_body">我是一直没去研究微软自带的身份认证和授权，都是用Session自己写一套控制</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261492,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261492,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261492_avatar" style="display:none;">http://pic.cnblogs.com/face/227601/20130129121810.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261496" class="layer">#15楼</a><a name="3261496" id="comment_anchor_3261496"></a>  <span class="comment_date">2015-09-07 11:19</span> <a id="a_comment_author_3261496" href="http://www.cnblogs.com/toutou/" target="_blank">请叫我头头哥</a> <a href="http://msg.cnblogs.com/send/%E8%AF%B7%E5%8F%AB%E6%88%91%E5%A4%B4%E5%A4%B4%E5%93%A5" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261496" class="blog_comment_body">支持城主， 这个日后肯定有用！ 留个名！</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261496,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261496,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261496_avatar" style="display:none;">http://pic.cnblogs.com/face/506684/20150414234658.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261524" class="layer">#16楼</a><a name="3261524" id="comment_anchor_3261524"></a>  <span class="comment_date">2015-09-07 11:35</span> <a id="a_comment_author_3261524" href="http://www.cnblogs.com/ta-wuhen/" target="_blank">ta_wuhen</a> <a href="http://msg.cnblogs.com/send/ta_wuhen" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261524" class="blog_comment_body">感谢城主   学习了</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261524,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261524,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261565" class="layer">#17楼</a><a name="3261565" id="comment_anchor_3261565"></a>  <span class="comment_date">2015-09-07 12:04</span> <a id="a_comment_author_3261565" href="http://www.cnblogs.com/JunXiao/" target="_blank">润羲</a> <a href="http://msg.cnblogs.com/send/%E6%B6%A6%E7%BE%B2" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261565" class="blog_comment_body">楼主讲得不错 把asp.net验证和授权系统讲得很清晰 可是在我们开发项目的时候 往往都是用自己写的 没有用微软.NET自带的 ^_^ 如果会结合自己写一套身份验证和授权会更棒 支持支持</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261565,&#39;Digg&#39;,this)">支持(1)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261565,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261594" class="layer">#18楼</a><a name="3261594" id="comment_anchor_3261594"></a>  <span class="comment_date">2015-09-07 12:36</span> <a id="a_comment_author_3261594" href="http://www.cnblogs.com/GuZhenYin/" target="_blank">GuZhenYin</a> <a href="http://msg.cnblogs.com/send/GuZhenYin" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261594" class="blog_comment_body">感谢 期待下一篇</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261594,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261594,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261594_avatar" style="display:none;">http://pic.cnblogs.com/face/653851/20170727102407.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261616" class="layer">#19楼</a><a name="3261616" id="comment_anchor_3261616"></a>[<span class="louzhu">楼主</span>]  <span class="comment_date">2015-09-07 13:08</span> <a id="a_comment_author_3261616" href="http://www.cnblogs.com/OceanEyes/" target="_blank">木宛城主</a> <a href="http://msg.cnblogs.com/send/%E6%9C%A8%E5%AE%9B%E5%9F%8E%E4%B8%BB" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261616" class="blog_comment_body"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261453" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3261453);">@</a>
郭明锋<br>哈哈：）</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261616,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261616,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261616_avatar" style="display:none;">http://pic.cnblogs.com/face/299214/20150329043854.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261618" class="layer">#20楼</a><a name="3261618" id="comment_anchor_3261618"></a>[<span class="louzhu">楼主</span>]  <span class="comment_date">2015-09-07 13:09</span> <a id="a_comment_author_3261618" href="http://www.cnblogs.com/OceanEyes/" target="_blank">木宛城主</a> <a href="http://msg.cnblogs.com/send/%E6%9C%A8%E5%AE%9B%E5%9F%8E%E4%B8%BB" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261618" class="blog_comment_body"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261565" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3261565);">@</a>
润羲<br>不管白猫黑猫，能抓老鼠的就是好猫</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261618,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261618,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261618_avatar" style="display:none;">http://pic.cnblogs.com/face/299214/20150329043854.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261732" class="layer">#21楼</a><a name="3261732" id="comment_anchor_3261732"></a>  <span class="comment_date">2015-09-07 15:35</span> <a id="a_comment_author_3261732" href="http://www.cnblogs.com/ksart/" target="_blank">失落的野火</a> <a href="http://msg.cnblogs.com/send/%E5%A4%B1%E8%90%BD%E7%9A%84%E9%87%8E%E7%81%AB" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261732" class="blog_comment_body">好文，mark</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261732,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261732,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261732_avatar" style="display:none;">http://pic.cnblogs.com/face/u60959.jpg</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261844" class="layer">#22楼</a><a name="3261844" id="comment_anchor_3261844"></a>[<span class="louzhu">楼主</span>]  <span class="comment_date">2015-09-07 17:03</span> <a id="a_comment_author_3261844" href="http://www.cnblogs.com/OceanEyes/" target="_blank">木宛城主</a> <a href="http://msg.cnblogs.com/send/%E6%9C%A8%E5%AE%9B%E5%9F%8E%E4%B8%BB" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261844" class="blog_comment_body"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261732" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3261732);">@</a>
失落的野火<br>谢谢支持</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261844,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261844,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261844_avatar" style="display:none;">http://pic.cnblogs.com/face/299214/20150329043854.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261845" class="layer">#23楼</a><a name="3261845" id="comment_anchor_3261845"></a>[<span class="louzhu">楼主</span>]  <span class="comment_date">2015-09-07 17:03</span> <a id="a_comment_author_3261845" href="http://www.cnblogs.com/OceanEyes/" target="_blank">木宛城主</a> <a href="http://msg.cnblogs.com/send/%E6%9C%A8%E5%AE%9B%E5%9F%8E%E4%B8%BB" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261845" class="blog_comment_body"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261496" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3261496);">@</a>
请叫我头头哥<br>支持头哥</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261845,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261845,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261845_avatar" style="display:none;">http://pic.cnblogs.com/face/299214/20150329043854.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261847" class="layer">#24楼</a><a name="3261847" id="comment_anchor_3261847"></a>[<span class="louzhu">楼主</span>]  <span class="comment_date">2015-09-07 17:03</span> <a id="a_comment_author_3261847" href="http://www.cnblogs.com/OceanEyes/" target="_blank">木宛城主</a> <a href="http://msg.cnblogs.com/send/%E6%9C%A8%E5%AE%9B%E5%9F%8E%E4%B8%BB" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261847" class="blog_comment_body"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261455" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3261455);">@</a>
田园里的蟋蟀<br>谢谢蟋蟀支持</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261847,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261847,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261847_avatar" style="display:none;">http://pic.cnblogs.com/face/299214/20150329043854.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261848" class="layer">#25楼</a><a name="3261848" id="comment_anchor_3261848"></a>[<span class="louzhu">楼主</span>]  <span class="comment_date">2015-09-07 17:04</span> <a id="a_comment_author_3261848" href="http://www.cnblogs.com/OceanEyes/" target="_blank">木宛城主</a> <a href="http://msg.cnblogs.com/send/%E6%9C%A8%E5%AE%9B%E5%9F%8E%E4%B8%BB" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261848" class="blog_comment_body"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261475" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3261475);">@</a>
AaronYang<br>多谢支持</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261848,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261848,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261848_avatar" style="display:none;">http://pic.cnblogs.com/face/299214/20150329043854.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261850" class="layer">#26楼</a><a name="3261850" id="comment_anchor_3261850"></a>[<span class="louzhu">楼主</span>]  <span class="comment_date">2015-09-07 17:06</span> <a id="a_comment_author_3261850" href="http://www.cnblogs.com/OceanEyes/" target="_blank">木宛城主</a> <a href="http://msg.cnblogs.com/send/%E6%9C%A8%E5%AE%9B%E5%9F%8E%E4%B8%BB" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261850" class="blog_comment_body"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261461" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3261461);">@</a>
莱布尼茨<br>多谢支持，技术驱动项目，有时候我们不得不去深挖这些技术：）</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261850,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261850,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261850_avatar" style="display:none;">http://pic.cnblogs.com/face/299214/20150329043854.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261868" class="layer">#27楼</a><a name="3261868" id="comment_anchor_3261868"></a>  <span class="comment_date">2015-09-07 17:14</span> <a id="a_comment_author_3261868" href="http://www.cnblogs.com/vbfool/" target="_blank">vbfool</a> <a href="http://msg.cnblogs.com/send/vbfool" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3261868" class="blog_comment_body">用过这套身份验证之后，真的感觉，比自己写的什么身份验证强一截。<br>关键是Claim这东西爽的很。</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3261868,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3261868,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3261868_avatar" style="display:none;">http://pic.cnblogs.com/face/181045/20130802110703.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3262109" class="layer">#28楼</a><a name="3262109" id="comment_anchor_3262109"></a>  <span class="comment_date">2015-09-07 23:57</span> <a id="a_comment_author_3262109" href="http://www.cnblogs.com/hetong/" target="_blank">西门吹灯</a> <a href="http://msg.cnblogs.com/send/%E8%A5%BF%E9%97%A8%E5%90%B9%E7%81%AF" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3262109" class="blog_comment_body">城主 你用live write 写博客的时候  你的阅读目录是怎么弄的   还有就是 阅读目录下面的 黄色的那一块  怎么弄的。</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3262109,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3262109,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3262109_avatar" style="display:none;">http://pic.cnblogs.com/face/631409/20170509101222.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3262125" class="layer">#29楼</a><a name="3262125" id="comment_anchor_3262125"></a>  <span class="comment_date">2015-09-08 05:35</span> <a id="a_comment_author_3262125" href="http://www.cnblogs.com/SkyD/" target="_blank">斯克迪亚</a> <a href="http://msg.cnblogs.com/send/%E6%96%AF%E5%85%8B%E8%BF%AA%E4%BA%9A" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3262125" class="blog_comment_body"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261868" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3261868);">@</a>
vbfool<br><fieldset class="comment_quote"><legend><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261868" title="查看引用原文">引用</a></legend>用过这套身份验证之后，真的感觉，比自己写的什么身份验证强一截。<br>关键是Claim这东西爽的很。</fieldset><br>Claim到底是干啥的？</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3262125,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3262125,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3262125_avatar" style="display:none;">http://pic.cnblogs.com/face/u36576.jpg</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3262159" class="layer">#30楼</a><a name="3262159" id="comment_anchor_3262159"></a>  <span class="comment_date">2015-09-08 09:03</span> <a id="a_comment_author_3262159" href="http://www.cnblogs.com/vbfool/" target="_blank">vbfool</a> <a href="http://msg.cnblogs.com/send/vbfool" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3262159" class="blog_comment_body"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3262125" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3262125);">@</a>
斯克迪亚<br><fieldset class="comment_quote"><legend><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3262125" title="查看引用原文">引用</a></legend>@vbfool<br><fieldset class="comment_quote"><legend>引用</legend>引用用过这套身份验证之后，真的感觉，比自己写的什么身份验证强一截。<br>关键是Claim这东西爽的很。</fieldset><br>Claim到底是干啥的？</fieldset><br>其实说白了就是一个描述的Name Value，这样你可以给一个对象附带上足够多的属性，比如一个用户有什么角色，有什么权限，有什么其它的ID之类的。<br>而Claim本身又是可以序列化的，使得向其它模块传递信息非常简单。</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3262159,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3262159,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3262159_avatar" style="display:none;">http://pic.cnblogs.com/face/181045/20130802110703.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3262868" class="layer">#31楼</a><a name="3262868" id="comment_anchor_3262868"></a>  <span class="comment_date">2015-09-08 23:25</span> <a id="a_comment_author_3262868" href="http://www.cnblogs.com/liubiaocai/" target="_blank">lawbc</a> <a href="http://msg.cnblogs.com/send/lawbc" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3262868" class="blog_comment_body">貌似和membership差不多呀，不适用</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3262868,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3262868,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3262868_avatar" style="display:none;">http://pic.cnblogs.com/face/u36499.jpg?id=30171922</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3263320" class="layer">#32楼</a><a name="3263320" id="comment_anchor_3263320"></a>  <span class="comment_date">2015-09-09 15:26</span> <a id="a_comment_author_3263320" href="http://www.cnblogs.com/webhuahua/" target="_blank">玩吧华华</a> <a href="http://msg.cnblogs.com/send/%E7%8E%A9%E5%90%A7%E5%8D%8E%E5%8D%8E" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3263320" class="blog_comment_body"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3261245" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3261245);">@</a>
牧 童<br>学习了，讲解的很仔细，不过，在实际运用过程中，我也有和@牧 童同样的问题，[Authorize(Roles = "Administrator")]死写感觉不好。</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3263320,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3263320,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3263320_avatar" style="display:none;">http://pic.cnblogs.com/face/u45753.jpg</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3267616" class="layer">#33楼</a><a name="3267616" id="comment_anchor_3267616"></a>  <span class="comment_date">2015-09-16 10:25</span> <a id="a_comment_author_3267616" href="http://www.cnblogs.com/william-lin/" target="_blank">天使半只翼</a> <a href="http://msg.cnblogs.com/send/%E5%A4%A9%E4%BD%BF%E5%8D%8A%E5%8F%AA%E7%BF%BC" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3267616" class="blog_comment_body">最近在学习这方面的东西,非常感谢作者的讲解,<br>解决了心里很多的问题.</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3267616,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3267616,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3276746" class="layer">#34楼</a><a name="3276746" id="comment_anchor_3276746"></a>  <span class="comment_date">2015-09-29 16:10</span> <a id="a_comment_author_3276746" href="http://home.cnblogs.com/u/371311/" target="_blank">jorty</a> <a href="http://msg.cnblogs.com/send/jorty" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3276746" class="blog_comment_body">请教楼主一个线程问题,如下Login方式 await UserManager.FindAsync的目的是什么?await后开启新线程执行 UserManager.FindAsync方法,主线程是否等待该线程执行完成？一次请求中,如果主线程不等待异步线程执行完成,异步线程执行结果怎么处理,请楼主解惑,谢谢。<br><div class="cnblogs_Highlighter sh-gutter"><div><div id="highlighter_764765" class="syntaxhighlighter  csharp"><div class="toolbar"><span><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="csharp keyword">public</code> <code class="csharp plain">async Task&lt;ActionResult&gt; Login(LoginModel model,</code><code class="csharp keyword">string</code> <code class="csharp plain">returnUrl) </code></div><div class="line number2 index1 alt1"><code class="csharp plain">{ </code></div><div class="line number3 index2 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(ModelState.IsValid) </code></div><div class="line number4 index3 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{ </code></div><div class="line number5 index4 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">AppUser user = await UserManager.FindAsync(model.Name, model.Password); </code></div><div class="line number6 index5 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">....</code></div><div class="line number7 index6 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number8 index7 alt1"><code class="csharp plain">}</code></div></div></td></tr></tbody></table></div></div></div></div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3276746,&#39;Digg&#39;,this)">支持(1)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3276746,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3371059" class="layer">#35楼</a><a name="3371059" id="comment_anchor_3371059"></a>  <span class="comment_date">2016-03-03 13:45</span> <a id="a_comment_author_3371059" href="http://www.cnblogs.com/yuanyuan/" target="_blank">于为源</a> <a href="http://msg.cnblogs.com/send/%E4%BA%8E%E4%B8%BA%E6%BA%90" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3371059" class="blog_comment_body"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3276746" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3276746);">@</a>
jorty<br>这个问题我曾经看过一个文章是说，运行Asp.net的服务器如IIS，会有一个线程池，请求来了之后从池中取出一个线程处理登录请求，当执行到有await的位置时，新开一个后台线程执行耗时操作。而调用的线程则放回线程池。当后台线程执行完毕之后IIS会从线程池中随意取一个空闲线程继续执行直至返回相应。我现在也是这么理解的</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3371059,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3371059,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3371059_avatar" style="display:none;">http://pic.cnblogs.com/face/66691/20140210165037.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3475518" class="layer">#36楼</a><a name="3475518" id="comment_anchor_3475518"></a>  <span class="comment_date">2016-07-24 00:07</span> <a id="a_comment_author_3475518" href="http://www.cnblogs.com/Lxy-/" target="_blank">狂扁小朋友</a> <a href="http://msg.cnblogs.com/send/%E7%8B%82%E6%89%81%E5%B0%8F%E6%9C%8B%E5%8F%8B" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3475518" class="blog_comment_body">app.UseCookieAuthentication 是一个扩展方法，它的内部帮我们做了如下几件事：<br><br>使用app.Use(typeof(CookieAuthenticationMiddleware), app, options) 方法，将CookieAuthenticationMiddleware 中间件注册到OWIN Pipeline中<br>通过app.UseStageMarker(PipelineStage.Authenticate)方法，将前面添加的CookieAuthenticationMiddleware指定在 ASP.NET 集成管道（ASP.NET integrated pipeline）的AuthenticateRequest阶段执行<br>当调用（Invoke）此Middleware时，将调用CreateHandler方法返回CookieAuthenticationHandler对象，它包含 AuthenticateCoreAsync方法，在这个方法中，读取并且验证Cookie，然后通过AddUserIdentity方法创建ClaimsPrincipal对象并添加到Owin环境字典中，可以通过OwinContext对象Request.User可以获取当前用户。<br><br>这是一个典型Middleware中间件使用场景，说白了就是去处理Http请求并将数据存储到OWIN环境字典中进行传递。而CookieAuthenticationMiddleware所做的事其实和FormsAuthenticationModule做的事类似。<br><br><br>----------------------------------------------------------------------------------------------------------------------------------------------------------------<br><br>真的看不懂 感觉微软这套 身份验证 真的太复杂 学习成本 不比 自己构建一套身份验证 来的好</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3475518,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3475518,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3475518_avatar" style="display:none;">http://pic.cnblogs.com/face/619594/20140902201840.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3577119" class="layer">#37楼</a><a name="3577119" id="comment_anchor_3577119"></a>  <span class="comment_date">2016-12-10 00:43</span> <a id="a_comment_author_3577119" href="http://www.cnblogs.com/fit/" target="_blank">我不清楚是谁</a> <a href="http://msg.cnblogs.com/send/%E6%88%91%E4%B8%8D%E6%B8%85%E6%A5%9A%E6%98%AF%E8%B0%81" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3577119" class="blog_comment_body">为什么在 AuthorizeAttribute-&gt;AuthorizeCore-&gt;httpContext.User.Identity.IsAuthenticated 老是false?</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3577119,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3577119,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3686807" class="layer">#38楼</a><a name="3686807" id="comment_anchor_3686807"></a><span id="comment-maxId" style="display:none;">3686807</span><span id="comment-maxDate" style="display:none;">2017/5/8 16:06:20</span>  <span class="comment_date">2017-05-08 16:06</span> <a id="a_comment_author_3686807" href="http://www.cnblogs.com/woloveprogram/" target="_blank">我_爱编程</a> <a href="http://msg.cnblogs.com/send/%E6%88%91_%E7%88%B1%E7%BC%96%E7%A8%8B" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3686807" class="blog_comment_body">Mark</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3686807,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3686807,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	<div id="comments_pager_bottom"></div></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>
<div id="comment_form" class="commentform">
<a name="commentform"></a>
<div id="divCommentShow"></div>
<div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" onclick="return RefreshCommentList();" id="lnk_RefreshComments" runat="server" clientidmode="Static">刷新评论</a><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#" onclick="return RefreshPage();">刷新页面</a><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#top">返回顶部</a></div>
<div id="comment_form_container"><div class="login_tips">注册用户登录后才能发表评论，请 <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return login(&#39;commentform&#39;);">登录</a> 或 <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return register();">注册</a>，<a href="http://www.cnblogs.com/">访问</a>网站首页。</div></div>
<div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
<div id="ad_t2"><a href="http://www.ucancode.com/index.htm" target="_blank">【推荐】50万行VC++源码: 大型组态工控、电力仿真CAD与GIS源码库</a><br><a href="https://www.jiguang.cn/devservice?bky" target="_blank">【推荐】极光开发者服务平台，五大功能一站集齐</a><br><a href="https://dnspod.cloud.tencent.com/act/seckill?fromSource=gwzcw.410370.410370.410370" target="_blank">【推荐】腾讯云域名+云解析 限时折扣抓紧抢购</a><br><a href="http://click.aliyun.com/m/18488/" target="_blank">【推荐】阿里云“全民云计算”优惠升级</a><br><a href="https://cloud.tencent.com/developer/labs?fromSource=gwzcw.330910.330910.330910" target="_blank">【推荐】一小时搭建人工智能应用，让技术更容易入门</a><br></div>
<div id="opt_under_post"></div>
<div id="cnblogs_c1" class="c_ad_block"><a href="http://click.aliyun.com/m/26126/" target="_blank"><img width="300" height="250" src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/24442-20170718132533661-166801094.jpg" alt="阿里云0718"></a></div>
<div id="under_post_news"><div class="itnews c_ad_block"><b>最新IT新闻</b>:<br> ·  <a href="http://news.cnblogs.com/n/576636/" target="_blank">京东28元划痕传奇布：一抹去除汽车划痕</a><br> ·  <a href="http://news.cnblogs.com/n/576635/" target="_blank">比太阳能更稳的定发电技术：日本秀洋流黑科技</a><br> ·  <a href="http://news.cnblogs.com/n/576634/" target="_blank">西安女子获赠支付宝空白机票 目的地随便填</a><br> ·  <a href="http://news.cnblogs.com/n/576633/" target="_blank">索尼PlayStation官方推特被黑 结果出人意外</a><br> ·  <a href="http://news.cnblogs.com/n/576632/" target="_blank">丝般顺滑！安卓8.0正式版新功能体验：智能、人性化</a><br>» <a href="http://news.cnblogs.com/" title="IT新闻" target="_blank">更多新闻...</a></div></div>
<div id="cnblogs_c2" class="c_ad_block"><a href="https://www.jiguang.cn/devservice?source=bky&amp;hmsr=%E5%8D%9A%E5%AE%A2%E5%9B%AD&amp;hmpl=&amp;hmcu=&amp;hmkw=&amp;hmci=" target="_blank"><img width="468" height="60" src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/24442-20170727100914671-839522651.gif" alt="极光0801"></a></div>
<div id="under_post_kb"><div class="itnews c_ad_block" id="kb_block"><b>最新知识库文章</b>:<br><div id="kb_recent"> ·  <a href="http://kb.cnblogs.com/page/575829/" target="_blank">做到这一点，你也可以成为优秀的程序员</a><br> ·  <a href="http://kb.cnblogs.com/page/566880/" target="_blank">写给立志做码农的大学生</a><br> ·  <a href="http://kb.cnblogs.com/page/569057/" target="_blank">架构腐化之谜</a><br> ·  <a href="http://kb.cnblogs.com/page/572854/" target="_blank">学会思考，而不只是编程</a><br> ·  <a href="http://kb.cnblogs.com/page/574767/" target="_blank">编写Shell脚本的最佳实践</a><br></div>» <a href="http://kb.cnblogs.com/" target="_blank">更多知识库文章...</a></div></div>
<div id="HistoryToday" class="c_ad_block"></div>
<script type="text/javascript">
    fixPostBody();
    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);
    deliverAdT2();
    deliverAdC1();
    deliverAdC2();    
    loadNewsAndKb();
    loadBlogSignature();
    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);
    loadOptUnderPost();
    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   
</script>
</div>


	</div><!--end: forFlow -->
	</div><!--end: mainContent 主体内容容器-->

	<div id="sideBar">
		<div id="sideBarMain">
			
<!--done-->
<div class="newsItem">
<h3 class="catListTitle">公告</h3>
	<div id="blog-news"><p>微信公众号</p>
<img width="200px" height="200px" src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/o_qrcode_for_gh_455306acb3af_430.jpg">


<h3 style="background-color: #3E6D8E;
border-bottom: 2px solid #F90;
color: white;
font-size: 105%;
margin: 15px 0 5px;
padding: 2px 5px;
cursor: pointer;">About Me</h3>
<p><img src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/o_MVP.png" alt="">&nbsp;</p>
<p><br>
</p>
C# &amp; .NET交流群：
<a target="_blank" href="http://shang.qq.com/wpa/qunwpa?idkey=60001c3d8e382464db3891e0ab5c132695c1ee58c0dc8092852db6073d2c790b"><img border="0" src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/group.png" alt=".NET交流1（.NET）" title=".NET交流1（.NET）"></a>
<br>
SharePoint交流群：
<a target="_blank" href="http://shang.qq.com/wpa/qunwpa?idkey=4fd3826e28d62883d12382cbf90bb989a7799d2b36366f34c6b4590f96d4dbed"><img border="0" src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/group.png" alt="SharePoint 2013入门与提高" title="SharePoint 2013入门与提高"></a><div id="profile_block">昵称：<a href="http://home.cnblogs.com/u/OceanEyes/">木宛城主</a><br>园龄：<a href="http://home.cnblogs.com/u/OceanEyes/" title="入园时间：2011-05-10">6年3个月</a><br>荣誉：<a href="http://www.cnblogs.com/expert/">推荐博客</a><br>粉丝：<a href="http://home.cnblogs.com/u/OceanEyes/followers/">1454</a><br>关注：<a href="http://home.cnblogs.com/u/OceanEyes/followees/">0</a><div id="p_b_follow"><a href="javascript:void(0);" onclick="follow(&#39;7d9cc6a0-df7a-e011-a53f-842b2b196315&#39;)">+加关注</a></div></div></div><script type="text/javascript">loadBlogNews();</script>
</div>

			<div id="calendar"><div id="blog-calendar" style="display:none"></div><script type="text/javascript">loadBlogDefaultCalendar();</script></div>
			
			<div id="leftcontentcontainer">
				<div id="blog-sidecolumn"><div id="sidebar_search" class="sidebar-block"></div><div id="sidebar_recentposts" class="sidebar-block">
<div class="catListEssay">
<h3 class="catListTitle">最新随笔</h3>
<ul>
<li><a href="http://www.cnblogs.com/OceanEyes/p/log_strategy.html">1. Unity应用架构设计(13)——日志组件的实施</a></li><li><a href="http://www.cnblogs.com/OceanEyes/p/aop_in_action.html">2. Unity应用架构设计(12)——AOP思想的实践</a></li><li><a href="http://www.cnblogs.com/OceanEyes/p/implement_a_interpreter.html">3. 从编译原理看一个解释器的实现</a></li><li><a href="http://www.cnblogs.com/OceanEyes/p/building_service_layer.html">4. Unity应用架构设计(11)——一个网络层的构建</a></li><li><a href="http://www.cnblogs.com/OceanEyes/p/coroutine_vs_multithreading_part2.html">5. Unity应用架构设计(10)——绕不开的协程和多线程（Part 2）</a></li><li><a href="http://www.cnblogs.com/OceanEyes/p/coroutine_vs_threading.html">6. Unity应用架构设计(10)——绕不开的协程和多线程（Part 1）</a></li><li><a href="http://www.cnblogs.com/OceanEyes/p/thinking_in_repository_pattern.html">7. Unity应用架构设计(9)——构建统一的 Repository</a></li><li><a href="http://www.cnblogs.com/OceanEyes/p/using_service_locator.html">8. Unity应用架构设计(8)——使用ServiceLocator实现对象的注入</a></li><li><a href="http://www.cnblogs.com/OceanEyes/p/factory_pattern.html">9. Unity应用架构设计(7)——IoC工厂理念先行</a></li><li><a href="http://www.cnblogs.com/OceanEyes/p/setting_up_observablelist.html">10. Unity应用架构设计(6)——设计动态数据集合ObservableList</a></li>
</ul>
</div>
</div><div id="sidebar_categories">
<div class="catListPostCategory">
<h3 class="catListTitle">随笔分类<span style="font-size:11px;font-weight:normal">(198)</span></h3>

<ul>

<li><a id="CatList_LinkList_0_Link_0" href="http://www.cnblogs.com/OceanEyes/category/839970.html">.NET Core(1)</a> </li>

<li><a id="CatList_LinkList_0_Link_1" href="http://www.cnblogs.com/OceanEyes/category/300842.html">Algorithms(2)</a> </li>

<li><a id="CatList_LinkList_0_Link_2" href="http://www.cnblogs.com/OceanEyes/category/374646.html">ASP.NET(5)</a> </li>

<li><a id="CatList_LinkList_0_Link_3" href="http://www.cnblogs.com/OceanEyes/category/404304.html">ASP.NET Essential(4)</a> </li>

<li><a id="CatList_LinkList_0_Link_4" href="http://www.cnblogs.com/OceanEyes/category/393525.html">ASP.NET MVC(12)</a> </li>

<li><a id="CatList_LinkList_0_Link_5" href="http://www.cnblogs.com/OceanEyes/category/696137.html">ASP.NET MVC 随想录(6)</a> </li>

<li><a id="CatList_LinkList_0_Link_6" href="http://www.cnblogs.com/OceanEyes/category/670354.html">Bootstrap(5)</a> </li>

<li><a id="CatList_LinkList_0_Link_7" href="http://www.cnblogs.com/OceanEyes/category/392686.html">CLR via C# 技术内幕(5)</a> </li>

<li><a id="CatList_LinkList_0_Link_8" href="http://www.cnblogs.com/OceanEyes/category/567607.html">Disaster Recovery(2)</a> </li>

<li><a id="CatList_LinkList_0_Link_9" href="http://www.cnblogs.com/OceanEyes/category/659690.html">Hyper-V(1)</a> </li>

<li><a id="CatList_LinkList_0_Link_10" href="http://www.cnblogs.com/OceanEyes/category/382251.html">JavaScript</a> </li>

<li><a id="CatList_LinkList_0_Link_11" href="http://www.cnblogs.com/OceanEyes/category/400473.html">Lucene.Net(1)</a> </li>

<li><a id="CatList_LinkList_0_Link_12" href="http://www.cnblogs.com/OceanEyes/category/466830.html">PowerShell For SharePoint(10)</a> </li>

<li><a id="CatList_LinkList_0_Link_13" href="http://www.cnblogs.com/OceanEyes/category/780275.html">Scrum(2)</a> </li>

<li><a id="CatList_LinkList_0_Link_14" href="http://www.cnblogs.com/OceanEyes/category/582195.html">SharePoint 2013 Step by Step(2)</a> </li>

<li><a id="CatList_LinkList_0_Link_15" href="http://www.cnblogs.com/OceanEyes/category/471158.html">SharePoint In Action(40)</a> </li>

<li><a id="CatList_LinkList_0_Link_16" href="http://www.cnblogs.com/OceanEyes/category/507122.html">SharePoint 项目实战(18)</a> </li>

<li><a id="CatList_LinkList_0_Link_17" href="http://www.cnblogs.com/OceanEyes/category/381976.html">SQL SERVER T-TQL(2)</a> </li>

<li><a id="CatList_LinkList_0_Link_18" href="http://www.cnblogs.com/OceanEyes/category/352178.html">Thinking In Design Pattern(9)</a> </li>

<li><a id="CatList_LinkList_0_Link_19" href="http://www.cnblogs.com/OceanEyes/category/827748.html">Unity 3D(16)</a> </li>

<li><a id="CatList_LinkList_0_Link_20" href="http://www.cnblogs.com/OceanEyes/category/972425.html">Unity应用架构设计(16)</a> </li>

<li><a id="CatList_LinkList_0_Link_21" href="http://www.cnblogs.com/OceanEyes/category/971418.html">VR SPACE</a> </li>

<li><a id="CatList_LinkList_0_Link_22" href="http://www.cnblogs.com/OceanEyes/category/613125.html">跟我学SharePoint 2013视频培训课程(15)</a> </li>

<li><a id="CatList_LinkList_0_Link_23" href="http://www.cnblogs.com/OceanEyes/category/353453.html">架构思想(10)</a> </li>

<li><a id="CatList_LinkList_0_Link_24" href="http://www.cnblogs.com/OceanEyes/category/350874.html">木宛城(3)</a> </li>

<li><a id="CatList_LinkList_0_Link_25" href="http://www.cnblogs.com/OceanEyes/category/385667.html">网络编程(1)</a> </li>

<li><a id="CatList_LinkList_0_Link_26" href="http://www.cnblogs.com/OceanEyes/category/401324.html">项目管理(3)</a> </li>

<li><a id="CatList_LinkList_0_Link_27" href="http://www.cnblogs.com/OceanEyes/category/353286.html">杂谈(7)</a> </li>

</ul>

</div>

<div class="catListPostArchive">
<h3 class="catListTitle">随笔档案<span style="font-size:11px;font-weight:normal">(152)</span></h3>

<ul>

<li><a id="CatList_LinkList_1_Link_0" href="http://www.cnblogs.com/OceanEyes/archive/2017/07.html">2017年7月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_1" href="http://www.cnblogs.com/OceanEyes/archive/2017/06.html">2017年6月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_2" href="http://www.cnblogs.com/OceanEyes/archive/2017/05.html">2017年5月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_3" href="http://www.cnblogs.com/OceanEyes/archive/2017/03.html">2017年3月 (11)</a> </li>

<li><a id="CatList_LinkList_1_Link_4" href="http://www.cnblogs.com/OceanEyes/archive/2016/06.html">2016年6月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_5" href="http://www.cnblogs.com/OceanEyes/archive/2016/05.html">2016年5月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_6" href="http://www.cnblogs.com/OceanEyes/archive/2016/01.html">2016年1月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_7" href="http://www.cnblogs.com/OceanEyes/archive/2015/09.html">2015年9月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_8" href="http://www.cnblogs.com/OceanEyes/archive/2015/08.html">2015年8月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_9" href="http://www.cnblogs.com/OceanEyes/archive/2015/07.html">2015年7月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_10" href="http://www.cnblogs.com/OceanEyes/archive/2015/06.html">2015年6月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_11" href="http://www.cnblogs.com/OceanEyes/archive/2015/05.html">2015年5月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_12" href="http://www.cnblogs.com/OceanEyes/archive/2015/04.html">2015年4月 (3)</a> </li>

<li><a id="CatList_LinkList_1_Link_13" href="http://www.cnblogs.com/OceanEyes/archive/2015/03.html">2015年3月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_14" href="http://www.cnblogs.com/OceanEyes/archive/2015/02.html">2015年2月 (6)</a> </li>

<li><a id="CatList_LinkList_1_Link_15" href="http://www.cnblogs.com/OceanEyes/archive/2015/01.html">2015年1月 (13)</a> </li>

<li><a id="CatList_LinkList_1_Link_16" href="http://www.cnblogs.com/OceanEyes/archive/2014/09.html">2014年9月 (3)</a> </li>

<li><a id="CatList_LinkList_1_Link_17" href="http://www.cnblogs.com/OceanEyes/archive/2014/08.html">2014年8月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_18" href="http://www.cnblogs.com/OceanEyes/archive/2014/07.html">2014年7月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_19" href="http://www.cnblogs.com/OceanEyes/archive/2014/06.html">2014年6月 (7)</a> </li>

<li><a id="CatList_LinkList_1_Link_20" href="http://www.cnblogs.com/OceanEyes/archive/2014/05.html">2014年5月 (3)</a> </li>

<li><a id="CatList_LinkList_1_Link_21" href="http://www.cnblogs.com/OceanEyes/archive/2014/04.html">2014年4月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_22" href="http://www.cnblogs.com/OceanEyes/archive/2014/03.html">2014年3月 (9)</a> </li>

<li><a id="CatList_LinkList_1_Link_23" href="http://www.cnblogs.com/OceanEyes/archive/2014/02.html">2014年2月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_24" href="http://www.cnblogs.com/OceanEyes/archive/2014/01.html">2014年1月 (5)</a> </li>

<li><a id="CatList_LinkList_1_Link_25" href="http://www.cnblogs.com/OceanEyes/archive/2013/12.html">2013年12月 (5)</a> </li>

<li><a id="CatList_LinkList_1_Link_26" href="http://www.cnblogs.com/OceanEyes/archive/2013/11.html">2013年11月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_27" href="http://www.cnblogs.com/OceanEyes/archive/2013/10.html">2013年10月 (5)</a> </li>

<li><a id="CatList_LinkList_1_Link_28" href="http://www.cnblogs.com/OceanEyes/archive/2013/09.html">2013年9月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_29" href="http://www.cnblogs.com/OceanEyes/archive/2013/08.html">2013年8月 (3)</a> </li>

<li><a id="CatList_LinkList_1_Link_30" href="http://www.cnblogs.com/OceanEyes/archive/2013/07.html">2013年7月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_31" href="http://www.cnblogs.com/OceanEyes/archive/2013/06.html">2013年6月 (4)</a> </li>

<li><a id="CatList_LinkList_1_Link_32" href="http://www.cnblogs.com/OceanEyes/archive/2013/04.html">2013年4月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_33" href="http://www.cnblogs.com/OceanEyes/archive/2013/03.html">2013年3月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_34" href="http://www.cnblogs.com/OceanEyes/archive/2012/12.html">2012年12月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_35" href="http://www.cnblogs.com/OceanEyes/archive/2012/11.html">2012年11月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_36" href="http://www.cnblogs.com/OceanEyes/archive/2012/10.html">2012年10月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_37" href="http://www.cnblogs.com/OceanEyes/archive/2012/09.html">2012年9月 (4)</a> </li>

<li><a id="CatList_LinkList_1_Link_38" href="http://www.cnblogs.com/OceanEyes/archive/2012/08.html">2012年8月 (7)</a> </li>

<li><a id="CatList_LinkList_1_Link_39" href="http://www.cnblogs.com/OceanEyes/archive/2012/07.html">2012年7月 (9)</a> </li>

<li><a id="CatList_LinkList_1_Link_40" href="http://www.cnblogs.com/OceanEyes/archive/2012/06.html">2012年6月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_41" href="http://www.cnblogs.com/OceanEyes/archive/2012/05.html">2012年5月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_42" href="http://www.cnblogs.com/OceanEyes/archive/2012/04.html">2012年4月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_43" href="http://www.cnblogs.com/OceanEyes/archive/2012/03.html">2012年3月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_44" href="http://www.cnblogs.com/OceanEyes/archive/2012/02.html">2012年2月 (4)</a> </li>

<li><a id="CatList_LinkList_1_Link_45" href="http://www.cnblogs.com/OceanEyes/archive/2012/01.html">2012年1月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_46" href="http://www.cnblogs.com/OceanEyes/archive/2011/10.html">2011年10月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_47" href="http://www.cnblogs.com/OceanEyes/archive/2011/07.html">2011年7月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_48" href="http://www.cnblogs.com/OceanEyes/archive/2011/05.html">2011年5月 (2)</a> </li>

</ul>

</div>

</div><div id="sidebar_recentcomments" class="sidebar-block"><div id="recent_comments_wrap">
<div class="catListComment">
<h3 class="catListTitle">最新评论</h3>
	<div id="RecentCommentsBlock"><ul>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/asp-net-identity-claim-based-authorization.html#3759494">1. Re:ASP.NET MVC 随想录——  使用ASP.NET Identity实现基于声明的授权，高级篇</a></li>
        <li class="recent_comment_body">喜欢楼主的写作风格，特别喜欢最后那一句话。。。</li>
        <li class="recent_comment_author">--随心520</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/using-bootstrap-javascript-plugins.html#3752670">2. Re:ASP.NET MVC使用Bootstrap系列（4）——使用JavaScript插件</a></li>
        <li class="recent_comment_body">好文章</li>
        <li class="recent_comment_author">--墨暖</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/archive/2012/08/13/aspnetEssential-1.html#3741668">3. Re:ASP.NET那点不为人知的事（一）</a></li>
        <li class="recent_comment_body">请问楼主大牛还有邹老师的视频吗？网上好像找不到了</li>
        <li class="recent_comment_author">--又见阿郎</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/archive/2012/08/13/aspnetEssential-1.html#3730972">4. Re:ASP.NET那点不为人知的事（一）</a></li>
        <li class="recent_comment_body">为什么不管看多少遍，能记住的也就只有里面两三个方法？是因为我始终找不到场景使用吗？</li>
        <li class="recent_comment_author">--故乡的星空</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/get-started-with-bootstrap.html#3730142">5. Re:ASP.NET MVC使用Bootstrap系列（1）——开始使用Bootstrap</a></li>
        <li class="recent_comment_body">最新Bootstrap手册：<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html" target="_blank"></a></li>
        <li class="recent_comment_author">--武鸿达</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/creating-bootstrap-helpers.html#3729912">6. Re:ASP.NET MVC使用Bootstrap系列（5）——创建ASP.NET MVC Bootstrap Helpers</a></li>
        <li class="recent_comment_body">最新Bootstrap手册：<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html" target="_blank"></a></li>
        <li class="recent_comment_author">--武鸿达</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/using-bootstrap-components.html#3729636">7. Re:ASP.NET MVC使用Bootstrap系列（3）——使用Bootstrap 组件</a></li>
        <li class="recent_comment_body">最新Bootstrap手册：<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html" target="_blank"></a></li>
        <li class="recent_comment_author">--武鸿达</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/bootstrap-html-elements.html#3729588">8. Re:ASP.NET MVC使用Bootstrap系统（2）——使用Bootstrap CSS和HTML元素</a></li>
        <li class="recent_comment_body">最新Bootstrap手册：<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html" target="_blank"></a></li>
        <li class="recent_comment_author">--武鸿达</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/aop_in_action.html#3728768">9. Re:Unity应用架构设计(12)——AOP思想的实践</a></li>
        <li class="recent_comment_body">支持一下！</li>
        <li class="recent_comment_author">--马三小伙儿</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/aop_in_action.html#3728559">10. Re:Unity应用架构设计(12)——AOP思想的实践</a></li>
        <li class="recent_comment_body">@Lemon丶说得好，受教了...</li>
        <li class="recent_comment_author">--木宛城主</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/aop_in_action.html#3728558">11. Re:Unity应用架构设计(12)——AOP思想的实践</a></li>
        <li class="recent_comment_body">@木宛城主反射性能是一回事。另一方面，aop 是否支持拦截器管道链式调用，aop是否可以简便配置，以及能否和IoC友好的集成都是需要考虑的地方...</li>
        <li class="recent_comment_author">--Lemon丶</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/aop_in_action.html#3728477">12. Re:Unity应用架构设计(12)——AOP思想的实践</a></li>
        <li class="recent_comment_body">@Lemon丶好的。不过反射性能，仁者见仁智者见智吧，很多框架都是基于反射实现的。...</li>
        <li class="recent_comment_author">--木宛城主</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/aop_in_action.html#3728474">13. Re:Unity应用架构设计(12)——AOP思想的实践</a></li>
        <li class="recent_comment_body">直接反射不是一个好的实践~<br>对于.net上的AOP ，最佳实践可以看我写的 <a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html" target="_blank"></a></li>
        <li class="recent_comment_author">--Lemon丶</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-get-started-with-identity.html#3725156">14. Re:ASP.NET MVC 随想录——开始使用ASP.NET Identity，初级篇</a></li>
        <li class="recent_comment_body">原来是迁移文件搞得鬼，虽然不懂原理，但是把迁移文件夹删除之后一切都好了</li>
        <li class="recent_comment_author">--BsaGyy</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-get-started-with-identity.html#3725144">15. Re:ASP.NET MVC 随想录——开始使用ASP.NET Identity，初级篇</a></li>
        <li class="recent_comment_body">为什么我照这么改了还是不能初始化数据库，崩溃了</li>
        <li class="recent_comment_author">--BsaGyy</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/implement_a_interpreter.html#3718773">16. Re:从编译原理看一个解释器的实现</a></li>
        <li class="recent_comment_body">直接使用Lua 就可以了啊！  在复杂的字符串表达式都是可以的</li>
        <li class="recent_comment_author">--游戏开发实验室</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/implement_a_interpreter.html#3717183">17. Re:从编译原理看一个解释器的实现</a></li>
        <li class="recent_comment_body">mark</li>
        <li class="recent_comment_author">--假程序猿</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/implement_a_interpreter.html#3717105">18. Re:从编译原理看一个解释器的实现</a></li>
        <li class="recent_comment_body">牛 深入简出！</li>
        <li class="recent_comment_author">--Crazy_Yang</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/implement_a_interpreter.html#3717048">19. Re:从编译原理看一个解释器的实现</a></li>
        <li class="recent_comment_body">学习一下</li>
        <li class="recent_comment_author">--自由布鲁斯</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-get-started-with-identity.html#3711478">20. Re:ASP.NET MVC 随想录——开始使用ASP.NET Identity，初级篇</a></li>
        <li class="recent_comment_body">代码运行失败，数据库没有初始化的同学看这里：在 AppIdentityDbContext 里把 public class IdentityDbInit:NullDatabaseInitializer......</li>
        <li class="recent_comment_author">--科刘</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/asp-net-identity-claim-based-authorization.html#3710770">21. Re:ASP.NET MVC 随想录——  使用ASP.NET Identity实现基于声明的授权，高级篇</a></li>
        <li class="recent_comment_body">@偷得一日闲[Authorize(Roles = "BjStaff")]像这样肯定是写死了。我之前的一种实现方式是，有一个配置界面，配置用户和访问页面（Controller/Action）的关系。然后......</li>
        <li class="recent_comment_author">--木宛城主</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/asp-net-identity-claim-based-authorization.html#3710488">22. Re:ASP.NET MVC 随想录——  使用ASP.NET Identity实现基于声明的授权，高级篇</a></li>
        <li class="recent_comment_body">@木宛城主，楼主，关于ASP.NET Identity，我想请教个我一直没有搞明白的问题：按照ASP.NET Identity的设计，Role是可以在运行期增删的，但是Role对Controller的......</li>
        <li class="recent_comment_author">--偷得一日闲</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/building_service_layer.html#3709867">23. Re:Unity应用架构设计(11)——一个网络层的构建</a></li>
        <li class="recent_comment_body">@马三小伙儿多谢支持...</li>
        <li class="recent_comment_author">--木宛城主</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/building_service_layer.html#3709836">24. Re:Unity应用架构设计(11)——一个网络层的构建</a></li>
        <li class="recent_comment_body">支持一下~ 很不错~</li>
        <li class="recent_comment_author">--马三小伙儿</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-get-started-with-identity.html#3702311">25. Re:ASP.NET MVC 随想录——开始使用ASP.NET Identity，初级篇</a></li>
        <li class="recent_comment_body">@蝈蝈520Demo的的迁移策略是针对第三篇文章的，你试试：public class AppIdentityDbContext : IdentityDbContext { public......</li>
        <li class="recent_comment_author">--木宛城主</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-get-started-with-identity.html#3702295">26. Re:ASP.NET MVC 随想录——开始使用ASP.NET Identity，初级篇</a></li>
        <li class="recent_comment_body">“/”应用程序中的服务器错误。找不到对象“dbo.AspNetUsers”，因为它不存在或者您没有所需的权限。说明: 执行当前 Web 请求期间，出现未经处理的异常。请检查堆栈跟踪信息，以了解有关该错......</li>
        <li class="recent_comment_author">--蝈蝈520</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-get-started-with-identity.html#3702292">27. Re:ASP.NET MVC 随想录——开始使用ASP.NET Identity，初级篇</a></li>
        <li class="recent_comment_body">@风也无奈你解决没！...</li>
        <li class="recent_comment_author">--蝈蝈520</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/coroutine_vs_multithreading_part2.html#3701539">28. Re:Unity应用架构设计(10)——绕不开的协程和多线程（Part 2）</a></li>
        <li class="recent_comment_body">@大程序猿小故事过奖了...</li>
        <li class="recent_comment_author">--木宛城主</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/coroutine_vs_multithreading_part2.html#3701537">29. Re:Unity应用架构设计(10)——绕不开的协程和多线程（Part 2）</a></li>
        <li class="recent_comment_body">大神</li>
        <li class="recent_comment_author">--大程序猿小故事</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/coroutine_vs_multithreading_part2.html#3701510">30. Re:Unity应用架构设计(10)——绕不开的协程和多线程（Part 2）</a></li>
        <li class="recent_comment_body">@木宛城主 666，蛤蛤...</li>
        <li class="recent_comment_author">--马三小伙儿</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/coroutine_vs_multithreading_part2.html#3701509">31. Re:Unity应用架构设计(10)——绕不开的协程和多线程（Part 2）</a></li>
        <li class="recent_comment_body">@马三小伙儿可以的...</li>
        <li class="recent_comment_author">--木宛城主</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/coroutine_vs_multithreading_part2.html#3701507">32. Re:Unity应用架构设计(10)——绕不开的协程和多线程（Part 2）</a></li>
        <li class="recent_comment_body">学习一下，话说 “生产者-消费者模式” 这块用观察者模式来实现是不是可以呢？</li>
        <li class="recent_comment_author">--马三小伙儿</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/coroutine_vs_threading.html#3700133">33. Re:Unity应用架构设计(10)——绕不开的协程和多线程（Part 1）</a></li>
        <li class="recent_comment_body">@木宛城主哈哈 博主的文章很有质量，必看啊！...</li>
        <li class="recent_comment_author">--马三小伙儿</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/coroutine_vs_threading.html#3700129">34. Re:Unity应用架构设计(10)——绕不开的协程和多线程（Part 1）</a></li>
        <li class="recent_comment_body">@马三小伙儿多谢支持，每次都是你沙发：)...</li>
        <li class="recent_comment_author">--木宛城主</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/coroutine_vs_threading.html#3700127">35. Re:Unity应用架构设计(10)——绕不开的协程和多线程（Part 1）</a></li>
        <li class="recent_comment_body">非常不错~ 学习一下！</li>
        <li class="recent_comment_author">--马三小伙儿</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/using-bootstrap-components.html#3692329">36. Re:ASP.NET MVC使用Bootstrap系列（3）——使用Bootstrap 组件</a></li>
        <li class="recent_comment_body">mark</li>
        <li class="recent_comment_author">--马甲线</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#3686807">37. Re:ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇</a></li>
        <li class="recent_comment_body">Mark</li>
        <li class="recent_comment_author">--我_爱编程</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/archive/2012/08/27/linq-2.html#3681416">38. Re:Linq快速入门——Lambda表达式的前世今生</a></li>
        <li class="recent_comment_body">讲得很好，很具体，有事件的博客文章吗？</li>
        <li class="recent_comment_author">--XX的一些事一些情</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/factory_pattern.html#3656186">39. Re:Unity 3D Framework Designing(7)——IoC工厂理念先行</a></li>
        <li class="recent_comment_body">非常不错~ 支持一下~ 原来的公司也是用的依赖注入解耦的~</li>
        <li class="recent_comment_author">--马三小伙儿</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-get-started-with-identity.html#3654932">40. Re:ASP.NET MVC 随想录——开始使用ASP.NET Identity，初级篇</a></li>
        <li class="recent_comment_body">我第一次真心赞别人的文章. 你的写的真真好</li>
        <li class="recent_comment_author">--愚</li>
</ul>
</div>
</div>
</div></div></div><script type="text/javascript">loadBlogSideColumn();</script>
			</div>
			
		</div><!--end: sideBarMain -->
	</div><!--end: sideBar 侧边栏容器 -->
	<div class="clear"></div>
	</div><!--end: main -->
	<div class="clear"></div>
	<div id="footer">
		
<!--done-->
Copyright ©2017 木宛城主
	</div><!--end: footer -->
</div><!--end: home 自定义的最大容器 -->
<!--PageEndHtml Block Begin-->
<div align="center"><a href="http://www.inkjetdeals.info/brands/dell.html"><img border="0" src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/9248710.png" alt="multifunction lasers"><br>访问人数</a></div>
<script language="javascript" type="text/javascript">
//生成目录索引列表
function GenerateContentList()
{
    var jquery_h3_list = $('#cnblogs_post_body h3');//如果你的章节标题不是h3,只需要将这里的h3换掉即可
    if(jquery_h3_list .length<=0){
       jquery_h3_list=$('#cnblogs_post_body h1');
     }
    if(jquery_h3_list.length>0)
    {
        var content = '<a name="_labelTop"></a>';
        content    += '<div id="navCategory">';
        content    += '<p style="font-size:18px"><b>阅读目录</b></p>';
        content    += '<ul>';
        for(var i =0;i<jquery_h3_list.length;i++)
        {
            var go_to_top = '<div style="text-align: right"><a href="#_labelTop">回到顶部</a><a name="_label' + i + '"></a></div>';
            $(jquery_h3_list[i]).before(go_to_top);
            var li_content = '<li><a href="#_label' + i + '">' + $(jquery_h3_list[i]).text() + '</a></li>';
            content += li_content;
        }
        content    += '</ul>';
        content    += '</div>';
        if($('#cnblogs_post_body').length != 0 )
        {
            $($('#cnblogs_post_body')[0]).prepend(content);
        }
    }    
}
GenerateContentList();
</script>
<!--PageEndHtml Block Begin-->


<div id="roll">
	<div title="回到顶部" id="roll_top">
	</div>
</div>
<!-- JiaThis Button BEGIN -->
<script type="text/javascript" src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/jiathis_r.js.下载" charset="utf-8"></script><script src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/ckepop.js.下载" charset="utf-8"></script><script src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/ckecenterpop.js.下载" charset="utf-8"></script><script type="text/javascript" src="./ASP.NET MVC 随想录——探索ASP.NET Identity 身份验证和基于角色的授权，中级篇 - 木宛城主 - 博客园_files/plugin.client.js.下载" charset="utf-8"></script>
<!-- JiaThis Button END -->
<style>

	#back-to-top{
		position:fixed;
		bottom:150px;
		right:74px;
	}
	#back-to-top a{
		text-align:center;
		text-decoration:none;
		color:#d1d1d1;
		display:block;
		width:80px;
		/*使用CSS3中的transition属性给跳转链接中的文字添加渐变效果*/
		-moz-transition:color 1s; 
		-webkit-transition:color 1s;
		-o-transition:color 1s;
	}
	#back-to-top a:hover{
		color:#979797;
	}
	#back-to-top a span{
		border-radius:6px;
		display:block;
		height:80px;
		width:80px;
		background:url(http://pic002.cnblogs.com/images/2011/36987/2011051823234124.png) no-repeat center center;
		margin-bottom:5px;
		-moz-transition:background 1s;
		-webkit-transition:background 1s;
		-o-transition:background 1s;
	}
	#back-to-top a:hover span{
		background:#979797 url(http://pic002.cnblogs.com/images/2011/36987/2011051823234124.png) no-repeat center center;
	}
</style>
<script type="text/javascript">
  $("head").prepend('');

      $(document).ready(function () {
          //首先将#back-to-top隐藏
          $("#back-to-top").hide();
          //当滚动条的位置处于距顶部100像素以下时，跳转链接出现，否则消失
          $(function () {
              $(window).scroll(function () {
                  if ($(window).scrollTop() > 100) {
                      $("#back-to-top").fadeIn(1500);
                  }
                  else {
                      $("#back-to-top").fadeOut(1500);
                  }
              });
              //当点击跳转链接后，回到页面顶部位置
              $("#back-to-top").click(function () {
                  $('body,html').animate({ scrollTop: 0 }, 1000);
                  return false;
              });
          });
      });
  </script>
<p id="back-to-top" style="display: none;">
	<a href="http://www.cnblogs.com/OceanEyes/p/thinking-in-asp-net-mvc-apply-asp-net-identity-authentication.html#top"><span></span></a>
</p>
<script type="text/javascript">
     function SetFavorite(){
	if( $("#div_digg").length < 1 ){
		setTimeout(SetFavorite, 1000); return;
	}

	$("<div style='padding-bottom: 5px'></div>")
		.append($("<span class='icon_favorite' style='padding-top: 2px; padding-bottom: 2px'></span>"))
		.append($("#green_channel_follow").clone(true).text("关注木宛城主")
				.removeAttr("id").css({ "font-weight": "bold", "padding-left": "5px" }))
		.prependTo("#div_digg");
}
 SetFavorite();
</script>
<!--PageEndHtml Block End-->

<!--uMVVM-->
<!--PageEndHtml Block End-->


</body></html>