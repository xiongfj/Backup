/*!@license
 * Infragistics.Web.ClientUI Tree Grid 14.2.20142.1018
 *
 * Copyright (c) 2011-2014 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *	jquery-1.4.4.js
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	infragistics.dataSource.js
 *	infragistics.ui.shared.js
 *	infragistics.util.js
 *	infragistics.ui.grid.framework.js
 */
(function($){var _aNull=function(val){return val===null||val===undefined};$.widget("ui.igTreeGrid",{css:{containerClasses:"ui-igtreegrid",expandCellExpanded:"ui-icon ui-igtreegrid-expandbutton ui-igtreegrid-expandbuttonexpanded ui-icon-minus",expandCellCollapsed:"ui-icon ui-igtreegrid-expandbutton ui-icon-plus",expandButtonContainer:"ui-igtreegrid-expandbuttoncontainer-group-by",dataSkipCell:"ui-iggrid-nongrouprowemptycell ui-iggrid-last-emptycell",expandColumn:"ui-igtreegrid-expandercell",dataColumnExpandContainer:"ui-igtreegrid-expandcontainer",expandColumnContainer:"ui-igtreegrid-expandcol-container",expandContainer:"ui-igtreegrid-expandcell",expandHeaderCell:"ui-iggrid-expandheadercellgb ui-iggrid-header ui-widget-header",rowLevel:"ui-iggrid-rowlevel"},options:{indentation:30,expansionIndicatorVisibility:true,expandTooltip:$.ig.Grid.locale.expandTooltip,collapseTooltip:$.ig.Grid.locale.collapseTooltip,foreignKey:null,key:"ID",hierarchicalDataSource:true,initialExpandDepth:-1,dataValueForRootLayout:-1,renderExpandColumn:false,renderFirstDataCellFunc:null,dataSourceLayoutKey:null,initialDataBindDepth:-1,renderExpandCellFunc:null,dataSourceSettings:{filtering:{fromLevel:0,toLevel:-1,showHierarchicalData:true},sorting:{fromLevel:0,toLevel:-1}}},events:{rowExpanding:"rowExpanding",rowExpanded:"rowExpanded",rowCollapsing:"rowCollapsing",rowCollapsed:"rowCollapsed",childRowExpanding:"childRowExpanding",childRowExpanded:"childRowExpanded",childRowCollapsing:"childRowCollapsing",childRowCollapsed:"childRowCollapsed"},_create:function(){this._attachEvents();this.dataBind()},dataBind:function(){var dataOpts,hds,opts;this._tmpds=this.options.dataSource;dataOpts=this._initDataOptions();this.options.dataSource=null;opts=$.extend(true,{},this.options);this.options.dataSource=this._tmpds;this._tmpds=null;hds=new $.ig.TreeHierarchicalDataSource(dataOpts);opts.dataSource=hds;this.element.igGrid(opts)},_initDataOptions:function(){var opts,schema,instanceOfHds,o=this.options;if(_aNull(o.initialDataBindDepth)||isNaN(o.initialDataBindDepth)){o.initialDataBindDepth=-1}opts={responseDataKey:o.responseDataKey,responseTotalRecCountKey:o.responseTotalRecCountKey,dataSource:o.dataSource,primaryKey:o.primaryKey,localSchemaTransform:o.localSchemaTransform,autoCommit:o.autoCommit,odata:o.odata,serializeTransactionLog:o.serializeTransactionLog,updateUrl:o.updateUrl,restSettings:o.restSettings,dataSourcePopulated:$.proxy(this._transformDS,this),treeDS:{dataSourceLayoutKey:o.dataSourceLayoutKey,initialDataBindDepth:o.initialDataBindDepth,hierarchicalDataSource:o.hierarchicalDataSource,foreignKey:o.foreignKey,filtering:{fromLevel:o.dataSourceSettings.filtering.fromLevel,toLevel:o.dataSourceSettings.filtering.toLevel,showHierarchicalData:o.dataSourceSettings.filtering.showHierarchicalData},sorting:{fromLevel:o.dataSourceSettings.sorting.fromLevel,toLevel:o.dataSourceSettings.sorting.toLevel}}};if(o.dataSourceType!==null){opts.type=o.dataSourceType}schema=this._initHSchema();instanceOfHds=o.dataSource&&typeof o.dataSource._encodeHierarchicalUrlParams==="function"&&o.dataSource.settings&&o.dataSource.settings.hasOwnProperty&&o.dataSource.settings.hasOwnProperty("initialDataBindDepth");if(instanceOfHds&&o.dataSource.settings.schema===null||!instanceOfHds){opts=$.extend(opts,{schema:schema})}return opts},_getDataColumns:function(cols){var i,j,res=[],colsLength=cols.length,dCols;for(i=0;i<colsLength;i++){if(cols[i].group!==undefined&&cols[i].group!==null){dCols=this._getDataColumns(this._getDataColumns(cols[i].group));for(j=0;j<dCols.length;j++){res.push(dCols[j])}}else{res.push(cols[i])}}return res},_initHSchema:function(){var schema,i,j,rec,prop,cols=this._getDataColumns(this.options.columns),k,c;if(cols.length>0&&!this.options.autoGenerateColumns){schema={};schema.fields=[];j=0;for(i=0;i<cols.length;i++){if(cols[i].unbound===true){continue}schema.fields[j]={};schema.fields[j].name=cols[i].key;schema.fields[j].type=cols[i].dataType;j++}schema.searchField=this.options.responseDataKey}else if(this.options.autoGenerateColumns){schema={};schema.fields=[];if(this.options.dataSource&&this.options.dataSource.length&&this.options.dataSource.length>0&&$.type(this.options.dataSource)==="array"){rec=this.options.dataSource[0];for(prop in rec){if(rec.hasOwnProperty(prop)){for(k=0;k<cols;k++){if(cols[k].key===prop){c=cols[k];break}}if(_aNull(c)){schema.fields.push({name:prop,type:$.ig.getColType(rec[prop])})}else{if(c.unbound===true){continue}schema.fields.push({name:prop,type:c.dataType})}}}}}return schema},_renderRecords:function(ui,args){if(args.owner.id()!==this.grid.id()){return}var func=this.options.renderFirstDataCellFunc;if(func&&$.type(func)!=="function"){if(window[func]&&typeof window[func]==="function"){func=window[func]}}if(func&&$.type(func)==="function"){this._renderFirstDataCellHandler=func}else{this._renderFirstDataCellHandler=$.proxy(this._renderFirstDataCell,this)}func=this.options.renderExpandCellFunc;if(func&&$.type(func)!=="function"){if(window[func]&&typeof window[func]==="function"){func=window[func]}}if(func&&$.type(func)==="function"){this._renderExpandCellHandler=func}else{this._renderExpandCellHandler=$.proxy(this._renderExpandCell,this)}this._renderRecordsInternal();if(!this.options.renderExpandColumn){this.grid.container().find("span[data-expandcell-indicator]").bind("click.expanders",function(e){e.stopPropagation()})}return false},_renderRecordsInternal:function(){var grid=this.grid,ds=this.grid.dataSource.dataView(),tbody=grid.element.children("tbody"),fh=false,html;this._indent=this.options.indentation;if(this.grid._isMultiColumnGrid){this._colspan=this.grid.container().find("#"+this.grid.id()+" colgroup:first>col").length-1}else{if(this.grid.options.showHeader){this._colspan=this.grid.container().find("#"+this.grid.id()+(fh===true?"_headers":"")+" thead>tr:first").children("th:not(.ui-iggrid-expandheadercellgb)").length}else{this._colspan=this.grid.container().find("#"+this.grid.id()+" colgroup:first>col").length-1}}if(_aNull(this._dataBoundDepth)){this._dataBoundDepth=0}html=this._renderRecordsPerLayout(0,ds,0,ds.length-1,this.options.columnLayouts||grid.options.columnLayouts,false);if(this._shouldAddDataSkipColumn()){this._addDataSkipColumn()}tbody.show();if(window.MSApp===undefined){tbody.html(html)}else{MSApp.execUnsafeLocalFunction(function(){tbody.html(html)})}if(this.grid.options.width===null){this.grid._setContainerWidth(this.grid.container())}else{this.grid._updateGridContentWidth()}this.grid._trigger(this.grid.events.rowsRendered,null,{owner:this.grid,tbody:tbody})},_addDataSkipColumn:function(){if(!this.options.renderExpandColumn){return}var indent=0,grid=this.grid,indentation=parseInt(this.options.indentation,10),$thDataSkip,$gridColgroup,$headersTbl,$footersTbl,cf;if(this._dataBoundDepth>0){indent+=indentation*this._dataBoundDepth;if(this.options.indentation&&this.options.indentation.indexOf&&this.options.indentation.indexOf("%")>=0){indent=this.options.indentation}cf=grid.hasFixedColumns()&&this._columnFixing.options.fixingDirection==="left";if(cf){$gridColgroup=grid.fixedBodyContainer().find("colgroup:first")}else{$gridColgroup=grid.element.find("colgroup:first")}this._addColHelper($gridColgroup,indent);if(cf){$headersTbl=grid.fixedHeadersTable()}else{$headersTbl=grid.headersTable()}if($headersTbl.attr("id")!==grid.element.attr("id")){this._addColHelper($headersTbl.find("colgroup:first"),indent)}if(cf){$footersTbl=grid.fixedFootersTable()}else{$footersTbl=grid.footersTable()}if($footersTbl.attr("id")!==grid.element.attr("id")){this._addColHelper($footersTbl.find("colgroup"),indent)}if(!$headersTbl.find("> thead th[data-treeview-th]").length){$thDataSkip=$("<th></th>").prependTo($headersTbl.find("> thead tr:nth-child(1)"));$thDataSkip.addClass(this.css.expandHeaderCell).attr("data-skip",true).attr("data-treeview-th",true);if(grid._isMultiColumnGrid){$thDataSkip.attr("rowspan",grid._maxLevel+1)}}}},_addColHelper:function($colgroup,width){var $col=$colgroup.find("col[data-treeview-col]");if($col.length===0){$col=$("<col />").prependTo($colgroup).attr("data-skip","true").attr("data-treeview-col","true")}$col.width(width)},_headerRendered:function(sender,args){this.grid=args.owner;this._renderExtraHeaderCellHandler=$.proxy(this._renderExtraHeaderCells,this);this._renderExtraFooterCellHandler=$.proxy(this._renderExtraFooterCells,this);this.grid._headerInitCallbacks.push({type:"TreeView",func:this._renderExtraHeaderCellHandler});this.grid._footerInitCallbacks.push({type:"TreeView",func:this._renderExtraFooterCellHandler});args.owner._trigger("headerextracellsmodified",null,{owner:args.owner});this._updating=this.grid.element.data("igGridUpdating");this._tooltips=this.grid.element.data("igGridTooltips");this._columnFixing=this.grid.element.data("igGridColumnFixing");this._overrideGridFunctions();this.grid.container().addClass(this.css.containerClasses)},_renderRecordsPerLayout:function(dataBoundDepth,ds,start,end,layouts,parentLayoutCollapsed,isFixed){var i,html="",data,layout=null,indent,tmpLayouts,o=this.options,rowData,children,hasChildren,instanceOfDS,tmpParentLayoutCollapsed,dataSourceLayoutKey=o.dataSourceLayoutKey;if(!(o.indentation&&o.indentation.indexOf&&o.indentation.indexOf("%")!==-1)){indent=parseInt(o.indentation,10)*dataBoundDepth;if(this._indent<indent){this._indent=indent}}if(dataBoundDepth>this._dataBoundDepth){this._dataBoundDepth=dataBoundDepth}for(i=start;i<=end;i++){data=ds[i];hasChildren=false;children=data[dataSourceLayoutKey];if(children){instanceOfDS=children instanceof $.ig.DataSource;if(instanceOfDS){hasChildren=true;children=children.dataView()}else if(children.length>0||children===true){hasChildren=true}}tmpParentLayoutCollapsed=parentLayoutCollapsed;rowData={dataBoundDepth:dataBoundDepth,parentCollapsed:parentLayoutCollapsed,hasExpandCell:false,expand:false};if(hasChildren){rowData.hasExpandCell=true;rowData.expand=true;if(o.initialExpandDepth===-1||o.initialExpandDepth<=dataBoundDepth||layout&&layout.expanded===false){rowData.expand=false;tmpParentLayoutCollapsed=true}}html+=this._renderRecord(i,data,rowData,isFixed);if(hasChildren){if(layout&&layout.columnLayouts){tmpLayouts=layout.columnLayouts}if(o.initialDataBindDepth===-1||o.initialDataBindDepth>=dataBoundDepth+1){html+=this._renderRecordsPerLayout(dataBoundDepth+1,children,0,children.length-1,tmpLayouts,tmpParentLayoutCollapsed,isFixed)}}}return html},_gridRenderRecord:function(data,rowIndex,isFixed){return this._renderRecord(rowIndex,data,{dataBoundDepth:0,parentCollapsed:false},isFixed)},_renderRecord:function(rowIndex,data,rowData,isFixed){var html="",grid=this.grid,expState,markup,key=grid.options.primaryKey,dataBoundDepth=rowData.dataBoundDepth,ar=grid.options.accessibilityRendering,cssClass=this.css.rowLevel+dataBoundDepth;html+="<tr";if(rowIndex%2!==0&&grid.options.alternateRowStyles){cssClass+=" "+grid.css.recordAltClass}html+=' class="'+cssClass+'" data-row-idx="'+rowIndex+'" data-level="'+dataBoundDepth+'"';if(!_aNull(grid.options.foreignKey)){html+=" data-id-fk='"+grid._kval_from_key(grid.options.foreignKey,data)+"'"}if(!_aNull(key)){html+=' data-id="'+grid._kval_from_key(key,data)+'"'}else if(!_aNull(data.ig_pk)){html+=' data-id="'+data.ig_pk+'"'}if(rowData.hasExpandCell){expState=rowData.expand?"expanded":"collapsed";html+=' data-state="'+expState+'"'}if(rowData.parentCollapsed&&dataBoundDepth>0){html+=' style="display: none;"'}if(ar){html+=' role="row">'}else{html+=">"}if(this._shouldAddDataSkipColumn(isFixed)&&this.options.renderExpandColumn){html+=this._renderExpandCellHandler(rowData)}if(isFixed){markup=this._columnFixingRenderFixedRecordHandler(data,rowIndex)}else{markup=this._gridRenderRecordHandler(data,rowIndex)}html+=this._renderFirstDataCellHandler(markup,rowData);return html},_renderFirstDataCell:function(markup,rowData){var newTDSmarkup="",idxStart=markup.indexOf("<td"),TDSmarkup=markup.substring(idxStart),tdContentFirstInd=TDSmarkup.indexOf(">",2),otherTDSmarkup=TDSmarkup.substring(tdContentFirstInd+1);newTDSmarkup=TDSmarkup.substring(0,tdContentFirstInd)+' class="'+this.css.expandColumn+'"';if(this.options.renderExpandColumn){newTDSmarkup+=' data-cell-shift-container="1">'}else{newTDSmarkup+=' data-expand-cell="1">'}newTDSmarkup+=this._renderExpandCellContainer(rowData);newTDSmarkup+=otherTDSmarkup;return newTDSmarkup},_renderExpandCellContainer:function(rowData){var span="",margin,dataBoundDepth=rowData.dataBoundDepth;margin=dataBoundDepth>0?parseInt(this.options.indentation,10)*dataBoundDepth:0;if(this.options.renderExpandColumn){span='<span class="'+this.css.dataColumnExpandContainer+'" data-shift-container="1" style="display: inline-block; margin-left:'+margin+'px;"></span>'}else{span=this._renderExpandCellContainerHelper(rowData)}return span},_renderExpandCellContainerHelper:function(rowData){var span="",css,title,margin,dataBoundDepth=rowData.dataBoundDepth,cssEC=this.css.expandContainer,renderExpandButton=rowData.hasExpandCell;if(this.options.renderExpandColumn){cssEC=this.css.expandColumnContainer}margin=dataBoundDepth>0?parseInt(this.options.indentation,10)*dataBoundDepth:0;span='<span data-expandcell-indicator="1" class="'+cssEC+'" style="padding-left:'+margin+'px;">';if(renderExpandButton&&this.options.expansionIndicatorVisibility){if(rowData.expand){css=this.css.expandCellExpanded;title=this.options.collapseTooltip}else{css=this.css.expandCellCollapsed;title=this.options.expandTooltip}span+='<span data-expand-button class="'+css+'" title="'+title+'"></span>'}span+="</span>";return span},_renderExpandCell:function(rowData){if(!rowData.hasExpandCell){return this._renderDataSkipCell()}var html;if(this.options.expansionIndicatorVisibility){html='<td class="'+this.css.expandColumn+'" data-expand-cell="1" data-skip="true">'+this._renderExpandCellContainerHelper(rowData)+"</td>"}else{html='<td class="'+this.css.expandColumn+'" data-expand-cell="1" data-skip="true"></td>'}return html},_renderDataSkipCell:function(){return'<td css="'+this.css.dataSkipCell+'" data-skip="true"></td>'},_rerenderColgroups:function(){this._gridRerenderColgroupsHandler();this._addDataSkipColumn()},toggleRowById:function(id){var $row=this.grid.element.find("tr[data-id="+id+"]");this._toggleChildLayoutByRow($row,undefined,true)},_toggleChildLayout:function(event,args){var $row=$(event.target).closest("tr");this._toggleChildLayoutByRow($row)},_toggleChildLayoutByRow:function($row,styleDisplay,suppressEvents){var $nextRow=$row,foundUpperLevel=false,dL,levelCollapsed=null,noCancel=true,dataBoundDepth=parseInt($row.attr("data-level"),10),state=$row.attr("data-state"),expanded=state==="expanded";if(_aNull(styleDisplay)){styleDisplay=expanded?"none":""}if(!suppressEvents){if(expanded){noCancel=this._trigger(this.events.rowCollapsing,null,{owner:this,parentrow:$row,dataBoundDepth:dataBoundDepth})}else{noCancel=this._trigger(this.events.rowExpanding,null,{owner:this,parentrow:$row,dataBoundDepth:dataBoundDepth})}}if(noCancel){while($nextRow.length===1&&!foundUpperLevel){$nextRow=$nextRow.next("tr[data-level]");dL=parseInt($nextRow.attr("data-level"),10);if(isNaN(dL)||dL<=dataBoundDepth){foundUpperLevel=true;break}if(!expanded){if(levelCollapsed!==null){if(dL<=levelCollapsed){levelCollapsed=null}else{continue}}if($nextRow.attr("data-state")==="collapsed"){levelCollapsed=dL}}this._toggleRow($nextRow,styleDisplay,dL,suppressEvents)}if(expanded){$row.attr("data-state","collapsed").find("[data-expand-button]").attr("title",this.options.expandTooltip).removeClass(this.css.expandCellExpanded).addClass(this.css.expandCellCollapsed);if(!suppressEvents){this._trigger(this.events.rowCollapsed,null,{owner:this,parentrow:$row,dataBoundDepth:dataBoundDepth})}}else{$row.attr("data-state","expanded").find("[data-expand-button]").attr("title",this.options.collapseTooltip).removeClass(this.css.expandCellCollapsed).addClass(this.css.expandCellExpanded);if(!suppressEvents){this._trigger(this.events.rowExpanded,null,{owner:this,parentrow:$row,dataBoundDepth:dataBoundDepth})}}}},_toggleRow:function($row,styleDisplay,dataLevel,suppressEvents){var $anotherRow,noCancel=true,expanded=styleDisplay!=="none";if(!suppressEvents){if(expanded){noCancel=this._trigger(this.events.childRowExpanding,null,{owner:this,row:$row,dataBoundDepth:dataLevel})}else{noCancel=this._trigger(this.events.childRowCollapsing,null,{owner:this,row:$row,dataBoundDepth:dataLevel})}}if(noCancel){$row.css("display",styleDisplay);if(this.grid.hasFixedColumns()){$anotherRow=this._getAnotherRow($row);$anotherRow.css("display",styleDisplay);if($row.is(":visible")){$row.height("");$anotherRow.height("");this._columnFixing.syncRowsHeights($row,$anotherRow)}}if(!suppressEvents){if(expanded){this._trigger(this.events.childRowExpanded,null,{owner:this,row:$row,dataBoundDepth:dataLevel})}else{this._trigger(this.events.childRowCollapsed,null,{owner:this,row:$row,dataBoundDepth:dataLevel})}}}},_renderExtraHeaderCells:function(row,colgroup,prepend){if(!this.options.renderExpandColumn){return}if(prepend===true){$("<td></td>").prependTo(row).css("border-width",0).attr("data-skip",true);if(colgroup){$("<col />").prependTo(colgroup).attr("data-skip",true).css("width",this.options.indentation)}}else{$("<td></td>").appendTo(row).css("border-width",0).attr("data-skip",true);if(colgroup){$("<col />").appendTo(colgroup).attr("data-skip",true).css("width",this.options.indentation)}}},_renderFixedRecords:function($table,start,end,onlyRows,$trsUnfixed){if(onlyRows===true){this._columnFixingRenderFixedRecordsHandler($table,start,end,onlyRows,$trsUnfixed);return}var grid=this.grid,ds=grid.dataSource.dataView(),d="",noCancel=true;if(_aNull(start)){start=0;end=ds.length-1}if(_aNull(end)){end=start;if(end>ds.length-1){end=ds.length-1}start=0}if(start<0){start=0}if(end>ds.length-1){end=ds.length-1}if(noCancel){d+=this._renderRecordsPerLayout(0,ds,start,end,this.options.columnLayouts||grid.options.columnLayouts,false,true);$table.find("tbody").html(d)}},_renderFixedRecord:function(data,rowIndex,onlyRows,tr){if(onlyRows){return this._columnFixingRenderFixedRecordHandler(data,rowIndex,onlyRows,tr)}return this._gridRenderRecord(data,rowIndex,true)},_shouldAddDataSkipColumn:function(isFixed){var cf=this._columnFixing;if(!cf){return true}if(this.grid.hasFixedColumns()){if(isFixed){return cf.options.fixingDirection==="left"}return cf.options.fixingDirection!=="left"}return true},_getAnotherRow:function($row){var anotherRow,isFixed=this.grid._isFixedElement($row),index=$row.index();if(isFixed){anotherRow=this.grid.rowAt(index)}else{anotherRow=this.grid.fixedRowAt(index)}return $(anotherRow)},_columnFixedInternal:function(args){this._syncColumnFixingContainersHeights()},_dataSkipColumnFixedInternal:function(){this._syncColumnFixingContainersHeights()},_syncColumnFixingContainersHeights:function(){var grid=this.grid,id=grid.id(),scrollContainer;$("#"+id+"_fixedBodyContainer").find("table")[0].style.height="";if(grid.options.virtualization===true||grid.options.rowVirtualization===true){scrollContainer=this.grid._vdisplaycontainer()}else{scrollContainer=this.grid.scrollContainer()}if(scrollContainer.length===0){scrollContainer=this.grid.element}scrollContainer.find("table")[0].style.height=""},_getRecord:function(id){var record=this._updatingGetRecordHandler(id),pKey,data;if(!record){data=this.grid.dataSource._data;pKey=this.grid.options.primaryKey;if(_aNull(pKey)){pKey="ig_pk"}record=this._getRecordRecursive(id,data,pKey)}return record},_getRecordRecursive:function(id,data,pKey){var i,len=data.length,record,dataLayouts=[],dsLayoutKey=this.options.dataSourceLayoutKey;for(i=0;i<len;i++){if(data[i][pKey]===id){return data[i]}if(data[i][dsLayoutKey]){dataLayouts.push(data[i][dsLayoutKey])}}len=dataLayouts.length;for(i=0;i<len;i++){record=this._getRecordRecursive(id,dataLayouts[i],pKey);if(record){return record}}return null},_rowDeleting:function(e,args){var $row=args.row;if(!$row||!$row.length){return false}if($row.attr("data-state")){this._toggleChildLayoutByRow($row,"none")}},_generatePrimaryKeyValue:function(e,col){var value;if(col){value=this.grid.dataSource._data.length;col.value=value+1}},_renderRow:function(rec,tr,rowId){var $tr=$(tr),$span,rEC=this.options.renderExpandColumn;if(rEC){$span=$tr.find("span[data-shift-container]")}else{$span=$tr.find("[data-expandcell-indicator]").detach()}tr=this._gridRenderRowHandler(rec,tr,rowId);if($span.length>0){if(rEC){$span.prependTo($(tr).find("td[data-cell-shift-container]"))}else{$span.prependTo($(tr).find("td[data-expand-cell]"))}}return tr},_getElementValue:function(element){var $row=element.closest("tr"),id,pKey,cf,hskip=0,val,data=this.grid.dataSource.dataView(),key,col,record,hasFixedCols=this.grid.hasFixedColumns();if(this.grid.options.virtualization||this.grid.options.columnVirtualization){hskip=this.grid._startColIndex||0}if(element.attr("data-skip")){return val}if(hasFixedCols){cf=this.grid.element.data("igGridColumnFixing");col=element.index();key=cf._getKeyByVisibleIndex(col,this.grid._isFixedElement(element))}else{col=element.index()-this.grid.headersTable().find("thead").children(":first").children("th[data-skip='true']").length+hskip;if(col<0){return val}key=this.grid._visibleColumns()[col].key}pKey=this.grid.options.primaryKey;if(_aNull(pKey)){pKey="ig_pk"}id=$row.attr("data-id");if(_aNull(id)){return val}id=this.grid._fixPKValue(id);record=this._getRecordRecursive(id,data,pKey);if(!record){return null}val=record[key];if($.type(val)==="date"){if(this.grid.options.enableUTCDates===true){val=$.ig.formatter(val,"date","dateTime",true,this.grid.options.enableUTCDates)}}return val},_transformDS:function(dataSource,data){if($.type(data)!=="array"){return data}var i,rowData,parents=[],children=[],dataLen=data.length;for(i=0;i<dataLen;i++){rowData=data[i];if(this._hasRecordParent(rowData,data)){children.push(rowData)}else{parents.push(rowData)}}data=this._getDataLayouts(parents,children);this._DSTransformed=true;return data},_getDataLayouts:function(parents,children){var i,pLen=parents.length,key=this.options.key,res=[],parent,cp;for(i=0;i<pLen;i++){parent=parents[i];cp=this._getChildrenByKey(parents[i][key],children);children=cp.others;if(cp.children.length>0){parent[this.options.dataSourceLayoutKey]=this._getDataLayouts(cp.children,children)}res.push(parent)}return res},_getChildrenByKey:function(foreignKey,data){var i,dr,len=data.length,fKey=this.options.foreignKey,others=[],children=[];for(i=0;i<len;i++){dr=data[i];if(dr[fKey]===foreignKey){children.push(dr)}else{others.push(dr)}}return{children:children,others:others}},_hasRecordParent:function(dataRecord,ds){var i,dataRecordKey,dataRecordPKey,dsRowKey,o=this.options,rlv=o.dataValueForRootLayout,foreignKey=o.foreignKey,key=o.key;dataRecordPKey=dataRecord[foreignKey];if(_aNull(dataRecordPKey)){return false}if(rlv===false){dataRecordKey=dataRecord[key];if(_aNull(dataRecordKey)){return false}for(i=0;i<ds.length;i++){dsRowKey=ds[i][key];if(dsRowKey!==dataRecordKey&&dsRowKey===dataRecordPKey){return true}}return false}return dataRecordPKey!==rlv},_detachEvents:function(){var renderExpandColumn=this.options.renderExpandColumn,gridContainerId=this.element[0].id;if(this.element.is("div")){gridContainerId=this.element[0].id}else{gridContainerId+="_container"}if(this._rowsRenderingHandler){this.grid.element.unbind("iggridrowsrendering",this._rowsRenderingHandler)}if(this._dataRenderingHandler){this.grid.element.unbind("iggriddataempty",this._dataRenderingHandler)}if(this._toggleChildLayoutHandler){if(!renderExpandColumn){$(document).undelegate("#"+gridContainerId+" tr td span[data-expandcell-indicator]","mousedown",this._toggleChildLayoutHandler)}else{$(document).undelegate("#"+gridContainerId+" td[data-expand-cell=1]","mousedown",this._toggleChildLayoutHandler)}}if(this._columnFixedHandler){this.grid.element.unbind("iggridcolumnfixing_columnfixed",this._columnFixedHandler)}if(this._dataSkipColumnFixedHandler){this.grid.element.unbind("iggridcolumnfixing_dataskipcolumnfixed",this._dataSkipColumnFixedHandler)}if(this._rowDeletingHandler){this.grid.element.unbind("iggridupdating_rowdeleting",this._rowDeletingHandler)}if(this._generatePrimaryKeyValueHandler){this.grid.element.unbind("iggridupdatinggenerateprimarykeyvalue",this._generatePrimaryKeyValueHandler)}},_attachEvents:function(){var renderExpandColumn=this.options.renderExpandColumn,gridContainerId=this.element[0].id;if(this.element.is("div")){gridContainerId=this.element[0].id}else{gridContainerId+="_container"}this._headerRenderedHandler=$.proxy(this._headerRendered,this);this.element.bind("iggridheaderrenderedinternal",this._headerRenderedHandler);this._rowsRenderingHandler=$.proxy(this._renderRecords,this);this.element.bind("iggridrowsrendering",this._rowsRenderingHandler);this._dataRenderingHandler=$.proxy(this._dataEmpty,this);this.element.bind("iggriddataempty",this._dataRenderingHandler);this._toggleChildLayoutHandler=$.proxy(this._toggleChildLayout,this);if(!renderExpandColumn){$(document).delegate("#"+gridContainerId+" tr td span[data-expandcell-indicator]","mousedown",this._toggleChildLayoutHandler)}else{$(document).delegate("#"+gridContainerId+" td[data-expand-cell=1]","mousedown",this._toggleChildLayoutHandler)}this._columnFixedHandler=$.proxy(this._columnFixedInternal,this);this.element.bind("iggridcolumnfixing_columnfixed",this._columnFixedHandler);this._dataSkipColumnFixedHandler=$.proxy(this._dataSkipColumnFixedInternal,this);this.element.bind("iggridcolumnfixing_dataskipcolumnfixed",this._dataSkipColumnFixedHandler);this._rowDeletingHandler=$.proxy(this._rowDeleting,this);this.element.bind("iggridupdating_rowdeleting",this._rowDeletingHandler);this._generatePrimaryKeyValueHandler=$.proxy(this._generatePrimaryKeyValue,this);this.element.bind("iggridupdatinggenerateprimarykeyvalue",this._generatePrimaryKeyValueHandler)},_overrideGridFunctions:function(){this._gridRenderRecordHandler=$.proxy(this.grid._renderRecord,this.grid);this._renderRecordHandler=$.proxy(this._gridRenderRecord,this);this.grid._renderRecord=this._renderRecordHandler;this._gridRenderRowHandler=$.proxy(this.grid._renderRow,this.grid);this._renderRowHandler=$.proxy(this._renderRow,this);this.grid._renderRow=this._renderRowHandler;this._gridRerenderColgroupsHandler=$.proxy(this.grid._rerenderColgroups,this.grid);this.grid._rerenderColgroups=$.proxy(this._rerenderColgroups,this);if(this._updating){this._updatingGetRecordHandler=$.proxy(this._updating._getRecord,this._updating);this._getRecordHandler=$.proxy(this._getRecord,this);this._updating._getRecord=this._getRecordHandler}if(this._tooltips){this._tooltipGetElementValueHandler=$.proxy(this._tooltips._getElementValue,this._tooltips);this._tooltips._getElementValue=$.proxy(this._getElementValue,this)}if(this._columnFixing){this._columnFixingRenderFixedRecordsHandler=$.proxy(this._columnFixing._renderFixedRecords,this._columnFixing);this._columnFixing._renderFixedRecords=$.proxy(this._renderFixedRecords,this);this._columnFixingRenderFixedRecordHandler=$.proxy(this._columnFixing._renderFixedRecord,this._columnFixing);this._columnFixing._renderFixedRecord=$.proxy(this._renderFixedRecord,this)}},gridInstance:function(){return this.grid},destroy:function(){this._detachEvents();if(this._tooltips){this._tooltips._getElementValue=this._tooltipGetElementValueHandler}if(this._columnFixing){this._columnFixing._renderFixedRecords=this._columnFixingRenderFixedRecordsHandler;this._columnFixing._renderFixedRecord=this._columnFixingRenderFixedRecordHandler}if(this._gridRenderRecordHandler){this.grid._renderRecord=this._gridRenderRecordHandler}if(this._gridRerenderColgroupsHandler){this.grid._rerenderColgroups=this._gridRerenderColgroupsHandler}$.Widget.prototype.destroy.apply(this,arguments);this.grid.destroy();return this}});$.extend($.ui.igGridTreeView,{version:"14.2.20142.1018"})})(jQuery);